<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Density dependence • guppyDme</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Density dependence">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">guppyDme</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analyses

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DME-000_Tidy_data.html">Tidy the Data</a>
    </li>
    <li>
      <a href="../articles/DME-011_Measurement_consistency.html">Measurement Consistency</a>
    </li>
    <li>
      <a href="../articles/DME-010_Habitat_characteristics.html">Habitat Characteristics</a>
    </li>
    <li>
      <a href="../articles/DME-015_Habitat_area.html">Habitat Area</a>
    </li>
    <li>
      <a href="../articles/DME-016_Dispersal_and_habitat_shift.html">Dispersal and Habitat shift</a>
    </li>
    <li>
      <a href="../articles/DME-020_Density_dependence.html">Density Dependence</a>
    </li>
    <li>
      <a href="../articles/DME-030_Habitat_use.html">Habitat Use</a>
    </li>
    <li>
      <a href="../articles/DME-035_DD_habitat_use.html">Density-Dependent Habitat Use</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sebastianodebona/guppyDme" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Density dependence</h1>
                        <h4 data-toc-skip class="author">Seba De
Bona</h4>
            
      

      <div class="hidden name"><code>DME-020_Density_dependence.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview-setup">Overview &amp; Setup<a class="anchor" aria-label="anchor" href="#overview-setup"></a>
</h2>
<p>This vignette evaluates the effects of density manipulation on
fitness proxies such as recruitment in the pool, growth, and
condition.</p>
<p>Density dependence should lower some (or all) of these life-history
traits when density is increased, and viceversa when it’s decreased.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2     </span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'magrittr'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:purrr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     set_names</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:tidyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     extract</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: carData</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'car'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     recode</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:purrr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     some</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Matrix</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'Matrix'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following objects are masked from 'package:tidyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     expand, pack, unpack</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/lmerTestR" class="external-link">lmerTest</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'lmerTest'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:lme4':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     lmer</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     step</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># this vignette requires the package guppyDme to be installed. If the user wishes not to install the package, please comment out the "library(guppyDme)" line and run instead the lines commented out below</span></span>
<span></span>
<span><span class="co">#### If you have the guppyDme package installed</span></span>
<span><span class="co"># loading package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sebastianodebona.github.io/guppyDme/">guppyDme</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># #### If you do NOT wish to install the guppyDme package, please uncomment and run the following two lines of code, adding the package functions to the Global Environment and loading the data</span></span>
<span><span class="co"># source(file.path(here::here(), "R", "package_functions.R"))</span></span>
<span><span class="co"># load(file.path(here::here(), "data", "DMEdata.rda"))</span></span>
<span></span>
<span><span class="co"># loading the necessary data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">DMEdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sex_stage <span class="op">=</span> <span class="fu">score_sexst</span><span class="op">(</span><span class="va">.</span>, f_threshold <span class="op">=</span> <span class="fl">14</span>, f_unit <span class="op">=</span> <span class="st">"SL"</span><span class="op">)</span>,</span>
<span>         sex_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex_stage</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cr_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"DME_cr_data.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">treatment_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>,</span>
<span>                                   <span class="st">"DME_density_factor_in_treatments.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To make the interpretation of the following analyses easier, we will
center the variable <code>density_factor</code> (representing by how
much, proportionally, density was modified) to 1. This way, all
intercepts will refer to what happened in the control treatment. We will
also filter out the pools that were not part of the experiment, and
therefore that we are not interested in.</p>
<p>Since multiple authors took the measurements of standard length, to
account for any bias in measurement we will include as a random factor
in the models for growth the sequence of individuals who measured the
fish in the capture and recapture instance.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>density_factor <span class="op">=</span> <span class="va">density_factor</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>         marker_seq <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="va">marker_0</span>, <span class="va">marker_1</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,</span>
<span>         treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="growth">Growth<a class="anchor" aria-label="anchor" href="#growth"></a>
</h2>
<div class="section level3">
<h3 id="growth-dispersal">Growth &amp; Dispersal<a class="anchor" aria-label="anchor" href="#growth-dispersal"></a>
</h3>
<p>For growth, we will consider the effect of density manipulation on
the change in standard length (SL) with a <em>Linear mixed model</em>.
We will include whether an individuals has moved or not as a covariate,
to compare the effect of dispersal on growth (testing whether dispersal
is beneficial or not). Density factor is now centered on 1, so in the
intercept we have the control pool (for which density factor was 1).</p>
<p>To standardize growth across different streams, where fish were left
for different amounts of time, we will analyse growth over thirty days.
We will also scale SL, so the intercept does not refer to 0 length, but
the average length.</p>
<p><code>Stream_ID</code> will be included as a random factor to account
for differences in slope, shading etc. A factor that accounts for the
sequence of authors who measured the fish will be included to rule out
biases in SL measure.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>growth_30 <span class="op">=</span> <span class="va">growth</span><span class="op">*</span><span class="fl">30</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">interval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 26</span></span></span>
<span><span class="co">##   markID streamID treatment sex_stage_0 patch_0 habitat_0  SL_0 weight_0</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 6V7P   CL1      C         F           P16-22  E          18.0      0.1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 18 more variables: releaseDate &lt;date&gt;, marker_0 &lt;chr&gt;, patch_1 &lt;fct&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   habitat_1 &lt;fct&gt;, sex_stage_1 &lt;chr&gt;, SL_1 &lt;dbl&gt;, weight_1 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   captureDate &lt;date&gt;, marker_1 &lt;chr&gt;, pool_treat_0 &lt;chr&gt;, pool_treat_1 &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   moved &lt;lgl&gt;, hshift &lt;lgl&gt;, interval &lt;drtn&gt;, growth &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   density_factor &lt;dbl&gt;, marker_seq &lt;chr&gt;, growth_30 &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the individual recaptured after 9 days has a recorded growth which is unbelievable </span></span>
<span><span class="co"># when extrapolated. This can be due to undermeasuring, followed by overmeasuring,</span></span>
<span><span class="co"># and then extrapolated from the early growth. I will remove this individual.</span></span>
<span><span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SL_0s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">SL_0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">moved</span><span class="op">*</span><span class="va">density_factor</span>  <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex_stage_0</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">)</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># the three way interaction is not significant and can be dropped</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_0s</span><span class="op">+</span><span class="va">moved</span><span class="op">+</span><span class="va">density_factor</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># dropping SL x density</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">moved</span> <span class="op">+</span> <span class="va">moved</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># dropping moved x density</span></span>
<span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">moved</span> <span class="op">+</span> <span class="va">density_factor</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># stargazer needs objects that belong to lmer class, not lmerTest</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">g0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"lmerMod"</span></span>
<span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">g0</span>, <span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"html"</span>, report <span class="op">=</span> <span class="op">(</span><span class="st">'vcp*'</span><span class="op">)</span>,</span>
<span>                     title  <span class="op">=</span> <span class="st">"Model selection (continous density)"</span>,</span>
<span>                     dep.var.labels <span class="op">=</span> <span class="st">'Growth (mm/month)'</span>,</span>
<span>                     column.sep.width <span class="op">=</span> <span class="st">"10pt"</span>,</span>
<span>                     omit.stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bic"</span><span class="op">)</span>,</span>
<span>                     star.char <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'.'</span>, <span class="st">'*'</span>, <span class="st">'**'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Model selection (continous density)</strong>
</caption>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
Growth (mm/month)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s
</td>
<td>
-3.220
</td>
<td>
-1.205
</td>
<td>
-1.212
</td>
<td>
-1.211
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.000<sup>**</sup>
</td>
<td>
p = 0.000<sup>**</sup>
</td>
<td>
p = 0.000<sup>**</sup>
</td>
<td>
p = 0.000<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
moved
</td>
<td>
0.712
</td>
<td>
-0.634
</td>
<td>
-0.630
</td>
<td>
-0.565
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.243
</td>
<td>
p = 0.0001<sup>**</sup>
</td>
<td>
p = 0.0001<sup>**</sup>
</td>
<td>
p = 0.0002<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
density_factor
</td>
<td>
-1.077
</td>
<td>
-1.160
</td>
<td>
-1.104
</td>
<td>
-0.937
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.230
</td>
<td>
p = 0.00001<sup>**</sup>
</td>
<td>
p = 0.00001<sup>**</sup>
</td>
<td>
p = 0.00001<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:moved
</td>
<td>
2.529
</td>
<td>
0.527
</td>
<td>
0.545
</td>
<td>
0.560
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.007<sup>**</sup>
</td>
<td>
p = 0.022<sup>*</sup>
</td>
<td>
p = 0.017<sup>*</sup>
</td>
<td>
p = 0.014<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:density_factor
</td>
<td>
0.080
</td>
<td>
0.142
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.950
</td>
<td>
p = 0.484
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
movedTRUE:density_factor
</td>
<td>
0.753
</td>
<td>
0.756
</td>
<td>
0.689
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.589
</td>
<td>
p = 0.116
</td>
<td>
p = 0.144
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:movedTRUE:density_factor
</td>
<td>
-0.312
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.902
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.534
</td>
<td>
0.843
</td>
<td>
0.839
</td>
<td>
0.834
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.239
</td>
<td>
p = 0.004<sup>**</sup>
</td>
<td>
p = 0.004<sup>**</sup>
</td>
<td>
p = 0.005<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
76
</td>
<td>
312
</td>
<td>
312
</td>
<td>
312
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-106.934
</td>
<td>
-471.811
</td>
<td>
-471.379
</td>
<td>
-472.612
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
235.867
</td>
<td>
963.623
</td>
<td>
960.759
</td>
<td>
961.224
</td>
</tr>
<tr>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="4" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Smaller individuals who stay grow more compared to larger ones, hence
the negative effect of initial standard length. Among the individuals
who stay, higher densities cause growth to be lower. Individuals that
disperse have lower growth compared to those who stay, if they are
small. Larger individuals that disperse (from any treatment), on the
other hand, grow more.</p>
<p>To make sure we are not missing non-linear effects of the treatment,
we will run the same model with density expressed as a factor
(<code>treatment</code>).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g0b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">moved</span><span class="op">*</span><span class="va">treatment</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># 3-way can be dropped</span></span>
<span><span class="va">g1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_0s</span><span class="op">+</span><span class="va">moved</span><span class="op">+</span><span class="va">treatment</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">g0b</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">g1b</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"lmerMod"</span></span>
<span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">g0b</span>, <span class="va">g1b</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"html"</span>, report <span class="op">=</span> <span class="op">(</span><span class="st">'vcp*'</span><span class="op">)</span>,</span>
<span>                     title  <span class="op">=</span> <span class="st">"Model selection (factorial treatments)"</span>,</span>
<span>                     dep.var.labels <span class="op">=</span> <span class="st">'Growth (mm/month)'</span>,</span>
<span>                     column.sep.width <span class="op">=</span> <span class="st">"10pt"</span>,</span>
<span>                     omit.stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bic"</span><span class="op">)</span>,</span>
<span>                     star.char <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'.'</span>, <span class="st">'*'</span>, <span class="st">'**'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Model selection (factorial treatments)</strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Growth (mm/month)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s
</td>
<td>
-1.399
</td>
<td>
-1.390
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.000<sup>**</sup>
</td>
<td>
p = 0.000<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
moved
</td>
<td>
-0.377
</td>
<td>
-0.374
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.095<sup>.</sup>
</td>
<td>
p = 0.096<sup>.</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
treatmentD
</td>
<td>
0.903
</td>
<td>
0.915
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.00002<sup>**</sup>
</td>
<td>
p = 0.00002<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
treatmentI
</td>
<td>
-0.132
</td>
<td>
-0.133
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.419
</td>
<td>
p = 0.413
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:moved
</td>
<td>
0.615
</td>
<td>
0.521
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.057<sup>.</sup>
</td>
<td>
p = 0.023<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:treatmentD
</td>
<td>
0.279
</td>
<td>
0.249
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.101
</td>
<td>
p = 0.128
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:treatmentI
</td>
<td>
0.424
</td>
<td>
0.422
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.023<sup>*</sup>
</td>
<td>
p = 0.016<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
movedTRUE:treatmentD
</td>
<td>
-0.944
</td>
<td>
-0.899
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.033<sup>*</sup>
</td>
<td>
p = 0.039<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
movedTRUE:treatmentI
</td>
<td>
-0.155
</td>
<td>
-0.157
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.642
</td>
<td>
p = 0.635
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:movedTRUE:treatmentD
</td>
<td>
-0.418
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.498
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:movedTRUE:treatmentI
</td>
<td>
-0.049
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.927
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.684
</td>
<td>
0.683
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.013<sup>*</sup>
</td>
<td>
p = 0.013<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
312
</td>
<td>
312
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-469.182
</td>
<td>
-470.073
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
968.363
</td>
<td>
966.147
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">g3</span>, <span class="va">g1b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     df      AIC</span></span>
<span><span class="co">## g3   8 961.2237</span></span>
<span><span class="co">## g1b 13 966.1466</span></span></code></pre>
<p>When treatment is included as a factor variable, the best fit model
changes. The AIC difference though is &gt; 4, so we will pick the model
with density as a continuous factor. Below are some plots to visualize
the results.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="st">"(Intercept)"</span>, <span class="st">"Estimate"</span><span class="op">]</span></span>
<span><span class="va">b_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">g3</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="st">"SL_0s"</span>, <span class="st">"Estimate"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pred_growth <span class="op">=</span> <span class="va">alpha</span> <span class="op">+</span> <span class="va">b_size</span><span class="op">*</span><span class="va">SL_0s</span>,</span>
<span>         res <span class="op">=</span> <span class="va">growth_30</span> <span class="op">-</span> <span class="va">pred_growth</span><span class="op">)</span></span>
<span><span class="va">alt_data</span> <span class="op">&lt;-</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">treatment</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"I"</span><span class="op">)</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decreased"</span>, <span class="st">"control"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decreased"</span>, <span class="st">"control"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         boxplot_position <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>           <span class="va">treatment</span> <span class="op">==</span> <span class="st">"decreased"</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>           <span class="va">treatment</span> <span class="op">==</span> <span class="st">"control"</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>           <span class="va">treatment</span> <span class="op">==</span> <span class="st">"increased"</span> <span class="op">~</span> <span class="fl">0.5</span></span>
<span>         <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">alt_data</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">density_factor</span>, y <span class="op">=</span> <span class="va">res</span>, group <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, </span>
<span>             linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Growth residuals"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Proportional change in density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">boxplot_position</span>,</span>
<span>                   y <span class="op">=</span> <span class="va">res</span>,</span>
<span>                   fill <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>               outliers <span class="op">=</span> <span class="cn">F</span>,</span>
<span>               coef <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape<span class="op">=</span><span class="va">treatment</span>, </span>
<span>                  fill <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span>, </span>
<span>              position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span><span class="fl">0.03</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">22</span>, <span class="fl">24</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffb14e"</span>, <span class="st">"#cd34b5"</span>, <span class="st">"#0000ff"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#scale_color_manual(values = c("#ffb14e", "#cd34b5", "#0000ff")) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>        legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.80</span>,<span class="fl">0.85</span><span class="op">)</span>, </span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span>,</span>
<span>        plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now plotting size x moved interaction on growth</span></span>
<span><span class="va">sls</span> <span class="op">&lt;-</span> <span class="fu">modelr</span><span class="fu">::</span><span class="fu"><a href="https://modelr.tidyverse.org/reference/seq_range.html" class="external-link">seq_range</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">SL_0</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">mv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>SL_0 <span class="op">=</span> <span class="va">sls</span>,</span>
<span>                       moved <span class="op">=</span> <span class="va">mv</span>,</span>
<span>                       density_factor <span class="op">=</span> <span class="va">ds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SL_0s <span class="op">=</span> <span class="op">(</span><span class="va">SL_0</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:center"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:scale"</span><span class="op">)</span>,</span>
<span>         dispersed <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">moved</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YES"</span>, <span class="st">"NO"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         dispersed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dispersed</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">g3</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, re.form <span class="op">=</span> <span class="op">~</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alt_data</span> <span class="op">&lt;-</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dispersed <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">moved</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YES"</span>, <span class="st">"NO"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         dispersed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dispersed</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">alt_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, y <span class="op">=</span> <span class="va">growth_30</span>, <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Growth (mm/month)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Initial standard length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.75</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">dispersed</span>,</span>
<span>                             col <span class="op">=</span> <span class="va">dispersed</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">newdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, y <span class="op">=</span> <span class="va">pred</span>, </span>
<span>                                linetype <span class="op">=</span> <span class="va">dispersed</span>,</span>
<span>                                color <span class="op">=</span> <span class="va">dispersed</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#fa8775"</span>, <span class="st">"#9d02d7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>    legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">.85</span><span class="op">)</span>,  </span>
<span>    legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">pres</span>, <span class="va">plen</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">jpeg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"figures"</span>, <span class="st">"growth_by_treatment_and_dispersal.jpeg"</span><span class="op">)</span>,</span>
<span>     width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">4.5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">pres</span>, <span class="va">plen</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
<p>Plotted on the left are, on the y axis, the residual growth values
when standard length alone is ruled out. This is done by calculating the
predicted growth of individuals of a given standard length.</p>
</div>
<div class="section level3">
<h3 id="growth-habitat-change">Growth &amp; Habitat change<a class="anchor" aria-label="anchor" href="#growth-habitat-change"></a>
</h3>
<p>It might be interesting to check for effects of <em>habitat
shift</em> on growth for individuals who remain. We might expect that
individuals who moved to a different habitat would grow more. If the
opposite is true, this could suggest individuals being forced into
suboptimal habitats and paying the consequences in terms of growth.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we'll try to model with density as a continuous variable first</span></span>
<span><span class="va">gh0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">hshift</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># 3-way can go</span></span>
<span><span class="va">gh1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_0s</span><span class="op">+</span><span class="va">hshift</span><span class="op">+</span><span class="va">density_factor</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># hshift x density can go</span></span>
<span><span class="va">gh2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">hshift</span><span class="op">+</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># SL x density</span></span>
<span><span class="va">gh3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">hshift</span> <span class="op">+</span> <span class="va">density_factor</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># SL x hshift</span></span>
<span><span class="va">gh4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span> <span class="op">+</span> <span class="va">hshift</span> <span class="op">+</span> <span class="va">density_factor</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># and With density as a factor</span></span>
<span><span class="va">gh0b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">growth_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">treatment</span><span class="op">*</span><span class="va">hshift</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>                na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">gh4</span>, <span class="va">gh0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      df      AIC</span></span>
<span><span class="co">## gh4   7 778.8988</span></span>
<span><span class="co">## gh0b 15 782.1826</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the difference in AIC is small, so I will consider the most complex model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gh0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">## lmerModLmerTest]</span></span>
<span><span class="co">## Formula: growth_30 ~ SL_0s * treatment * hshift + (1 | streamID) + (1 |  </span></span>
<span><span class="co">##     marker_seq)</span></span>
<span><span class="co">##    Data: cr_table %&gt;% filter(!moved)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 752.2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.1127 -0.7251 -0.0225  0.6110  3.6448 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups     Name        Variance Std.Dev.</span></span>
<span><span class="co">##  marker_seq (Intercept) 0.1942   0.4406  </span></span>
<span><span class="co">##  streamID   (Intercept) 0.1630   0.4038  </span></span>
<span><span class="co">##  Residual               1.1638   1.0788  </span></span>
<span><span class="co">## Number of obs: 246, groups:  marker_seq, 5; streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                              Estimate Std. Error        df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)                   0.86759    0.35551   5.65285   2.440   0.0529 .  </span></span>
<span><span class="co">## SL_0s                        -1.21348    0.12845 231.02435  -9.447   &lt;2e-16 ***</span></span>
<span><span class="co">## treatmentD                    0.72305    0.30410 231.81885   2.378   0.0182 *  </span></span>
<span><span class="co">## treatmentI                   -0.00949    0.33375 230.18717  -0.028   0.9773    </span></span>
<span><span class="co">## hshiftTRUE                   -0.43937    0.20309 231.72551  -2.163   0.0315 *  </span></span>
<span><span class="co">## SL_0s:treatmentD             -0.08930    0.28312 229.45298  -0.315   0.7527    </span></span>
<span><span class="co">## SL_0s:treatmentI              0.13965    0.32286 230.28961   0.433   0.6658    </span></span>
<span><span class="co">## SL_0s:hshiftTRUE             -0.53196    0.20665 230.94018  -2.574   0.0107 *  </span></span>
<span><span class="co">## treatmentD:hshiftTRUE         0.31333    0.43338 232.04699   0.723   0.4704    </span></span>
<span><span class="co">## treatmentI:hshiftTRUE         0.07731    0.40311 231.68950   0.192   0.8481    </span></span>
<span><span class="co">## SL_0s:treatmentD:hshiftTRUE   0.81313    0.37166 230.09335   2.188   0.0297 *  </span></span>
<span><span class="co">## SL_0s:treatmentI:hshiftTRUE   0.62011    0.40841 229.76495   1.518   0.1303    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) SL_0s  trtmnD trtmnI hsTRUE SL_0s:D SL_0s:I SL_0:T tD:TRU</span></span>
<span><span class="co">## SL_0s       -0.116                                                          </span></span>
<span><span class="co">## treatmentD  -0.193  0.107                                                   </span></span>
<span><span class="co">## treatmentI  -0.157  0.144  0.173                                            </span></span>
<span><span class="co">## hshiftTRUE  -0.268  0.172  0.355  0.253                                     </span></span>
<span><span class="co">## SL_0s:trtmD  0.057 -0.444 -0.245 -0.059 -0.097                              </span></span>
<span><span class="co">## SL_0s:trtmI  0.057 -0.411 -0.054 -0.540 -0.069  0.180                       </span></span>
<span><span class="co">## SL_0s:hTRUE  0.037 -0.597 -0.055 -0.072 -0.159  0.265   0.239               </span></span>
<span><span class="co">## trtmnD:TRUE  0.123 -0.074 -0.703 -0.118 -0.503  0.176   0.031   0.068       </span></span>
<span><span class="co">## trtmnI:TRUE  0.133 -0.133 -0.183 -0.842 -0.499  0.059   0.460   0.090  0.256</span></span>
<span><span class="co">## SL_0:D:TRUE -0.023  0.337  0.198  0.047  0.117 -0.763  -0.138  -0.552 -0.285</span></span>
<span><span class="co">## SL_0:I:TRUE -0.021  0.307  0.044  0.414  0.088 -0.137  -0.777  -0.505 -0.046</span></span>
<span><span class="co">##             tI:TRU SL_0:D:</span></span>
<span><span class="co">## SL_0s                     </span></span>
<span><span class="co">## treatmentD                </span></span>
<span><span class="co">## treatmentI                </span></span>
<span><span class="co">## hshiftTRUE                </span></span>
<span><span class="co">## SL_0s:trtmD               </span></span>
<span><span class="co">## SL_0s:trtmI               </span></span>
<span><span class="co">## SL_0s:hTRUE               </span></span>
<span><span class="co">## trtmnD:TRUE               </span></span>
<span><span class="co">## trtmnI:TRUE               </span></span>
<span><span class="co">## SL_0:D:TRUE -0.075        </span></span>
<span><span class="co">## SL_0:I:TRUE -0.413  0.285</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gh4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">## lmerModLmerTest]</span></span>
<span><span class="co">## Formula: growth_30 ~ SL_0s + hshift + density_factor + (1 | streamID) +  </span></span>
<span><span class="co">##     (1 | marker_seq)</span></span>
<span><span class="co">##    Data: cr_table %&gt;% filter(!moved)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: 764.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.2846 -0.6298 -0.0045  0.5820  2.7919 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups     Name        Variance Std.Dev.</span></span>
<span><span class="co">##  marker_seq (Intercept) 0.1934   0.4398  </span></span>
<span><span class="co">##  streamID   (Intercept) 0.1571   0.3963  </span></span>
<span><span class="co">##  Residual               1.2262   1.1073  </span></span>
<span><span class="co">## Number of obs: 246, groups:  marker_seq, 5; streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                 Estimate Std. Error        df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)      0.94022    0.34297   5.37991   2.741   0.0377 *  </span></span>
<span><span class="co">## SL_0s           -1.20859    0.07609 239.85239 -15.883  &lt; 2e-16 ***</span></span>
<span><span class="co">## hshiftTRUE      -0.24619    0.14986 239.84849  -1.643   0.1017    </span></span>
<span><span class="co">## density_factor  -0.98639    0.24652 240.47139  -4.001 8.39e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) SL_0s  hsTRUE</span></span>
<span><span class="co">## SL_0s       -0.083              </span></span>
<span><span class="co">## hshiftTRUE  -0.253  0.022       </span></span>
<span><span class="co">## densty_fctr  0.026  0.000 -0.212</span></span></code></pre>
<p>Let’s plot the data together with the predictions from the factorial
treatment model.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span></span>
<span><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NO"</span>, <span class="st">"YES"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newdata_hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>SL_0 <span class="op">=</span> <span class="va">sls</span>,</span>
<span>                       hshift <span class="op">=</span> <span class="va">hs</span>,</span>
<span>                       treatment <span class="op">=</span> <span class="va">tts</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SL_0s <span class="op">=</span> <span class="op">(</span><span class="va">SL_0</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:center"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:scale"</span><span class="op">)</span>,</span>
<span>         hshift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">hshift</span><span class="op">)</span>,</span>
<span>         treatment_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>hab_pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gh0b</span>, newdata <span class="op">=</span> <span class="va">.</span>, re.form <span class="op">=</span> <span class="op">~</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">alt_data</span> <span class="op">&lt;-</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         hshift <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">hshift</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NO"</span>, <span class="st">"YES"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         hshift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">hshift</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">newdata_hab</span><span class="op">$</span><span class="va">hshift</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">labelss_treat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span> <span class="op">=</span> <span class="st">"decreased"</span>,</span>
<span>                   <span class="st">"C"</span> <span class="op">=</span> <span class="st">"control"</span>,</span>
<span>                   <span class="st">"I"</span> <span class="op">=</span> <span class="st">"increased"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pgh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">alt_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">hshift</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, y <span class="op">=</span> <span class="va">growth_30</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Growth (mm/month)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Initial standard length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">hshift</span>,</span>
<span>                 color <span class="op">=</span> <span class="va">hshift</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">newdata_hab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, y <span class="op">=</span> <span class="va">hab_pred</span>, linetype <span class="op">=</span> <span class="va">hshift</span>,</span>
<span>                                    color <span class="op">=</span> <span class="va">hshift</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">treatment_f</span>, </span>
<span>              labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>treatment_f <span class="op">=</span> <span class="va">labelss_treat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#fa8775"</span>, <span class="st">"#9d02d7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"microhabitat \nshift"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"microhabitat \nshift"</span>,</span>
<span>       shape <span class="op">=</span> <span class="st">"microhabitat \nshift"</span><span class="op">)</span></span>
<span><span class="va">pgh</span></span></code></pre></div>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">jpeg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"figures"</span>, <span class="st">"growth_by_habitat_and_treatment.jpeg"</span><span class="op">)</span>,</span>
<span>     width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">4</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">pgh</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>
AIC between the model with density as a continuous and treatment as a
factor is &lt; 4, so we will consider here the more complex model.</p>
<p>As expected, in the control larger individuals that do not change
their habitat grow less (- SL: p &lt; 0.001). Individuals that do change
their habitat in the control treatment experience an even smaller growth
(- hshift: p = 0.031), especially if large (- SL x hshift: p = 0.010).
This can be due to the fact that large individuals hold good quality
microhabitats at equilibrium conditions. Average sized individuals in
the decreased treatment have higher growth than in the control and
increased density treatment, if they do not disperse. This again, makes
sense given lower density provides weaker competition. Moreover, large
individuals in the decreased density treatment benefit from shifting
their habitat (SL x treatment x hshift: p = 0.013).</p>
</div>
</div>
<div class="section level2">
<h2 id="condition">Condition<a class="anchor" aria-label="anchor" href="#condition"></a>
</h2>
<div class="section level3">
<h3 id="condition-dispersal">Condition &amp; Dispersal<a class="anchor" aria-label="anchor" href="#condition-dispersal"></a>
</h3>
<p>An even shorter-term measure of fitness is individual condition. With
time, the idea is to evaluate the fat content of the preserved guppies,
but for now we can use a proxy for condition in the ratio between weight
and SL<sup>3</sup>.</p>
<p>Pregnancy in females complicates the picture, since female might gain
weight due to the development of embryos. So condition can only be
assessed for males and immature females.</p>
<p>Here I am just plotting weight over length to visualize the
relationship and see if there are crazy outliers that need to be
checked.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">labelss_recap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"capture"</span>,</span>
<span>                   <span class="st">"1"</span> <span class="op">=</span> <span class="st">"recapture"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex_stage</span><span class="op">)</span>, <span class="va">streamID</span> <span class="op">!=</span> <span class="st">"TM"</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">SL</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">weight</span>, color <span class="op">=</span> <span class="va">sex_stage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1E88E5"</span>, <span class="st">"#FFC107"</span>, <span class="st">"#004D40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Standard length (mm)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Weight (g)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">recap</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>recap <span class="op">=</span> <span class="va">labelss_recap</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): NAs introduced by coercion</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 970 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>All seems fine.</p>
<p><em>It is not a concern here, but when looking at the regression
size-weight of fish in TM, many males and juvenile males appear to have
a very high weight. The reported weight here matches with the physical
datasheets, so it’s not a typographical error. This can be due to
masculinized females, found sometimes in Taylor specifically.</em></p>
<p>We can now calculate condition, making sure to remove mature females
(whose estimated condition is affected by pregnancy). Since the length
is in mm and the weight in grams, the numbers are very small. We will
multiply the measures by 10<sup>3</sup> to turn it into a measure in the
unit mg/mm<sup>3</sup>.</p>
<p>As done for growth, we will calculate here difference in condition
over 30 days. we will also calculate the relative change in condition
over 30 days, as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mn>1</mn></msub><mo>−</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mn>0</mn></msub></mrow><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><msub><mi>n</mi><mn>0</mn></msub></mrow></mfrac><mfrac><mn>1</mn><mrow><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>a</mi><mi>l</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\frac{condition_1 - condition_0}{condition_0} \frac{1}{interval}
</annotation></semantics></math></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>condition_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sex_stage_0</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"M"</span><span class="op">)</span>, </span>
<span>                              <span class="va">weight_0</span><span class="op">*</span><span class="fl">1000</span><span class="op">/</span><span class="op">(</span><span class="va">SL_0</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                              <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         condition_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sex_stage_1</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"M"</span><span class="op">)</span>, </span>
<span>                              <span class="va">weight_1</span><span class="op">*</span><span class="fl">1000</span><span class="op">/</span><span class="op">(</span><span class="va">SL_1</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                              <span class="cn">NA</span><span class="op">)</span>,</span>
<span>         cond_diff <span class="op">=</span> <span class="va">condition_1</span><span class="op">-</span><span class="va">condition_0</span>,</span>
<span>         cond_diff_30 <span class="op">=</span> <span class="va">cond_diff</span><span class="op">*</span><span class="fl">30</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">interval</span><span class="op">)</span>,</span>
<span>         rel_cond_change <span class="op">=</span> <span class="op">(</span><span class="va">condition_1</span><span class="op">-</span><span class="va">condition_0</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">condition_0</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">interval</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">cond_diff_30</span><span class="op">)</span></span></code></pre></div>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">rel_cond_change</span><span class="op">)</span></span></code></pre></div>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<p>We can now test the effect of density on condition. We will adopt a
stepwise model simplification by removing non-significant interactions
and main effects, as we have done so far.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="va">SL_0s</span> <span class="op">*</span> <span class="va">density_factor</span> <span class="op">*</span> <span class="va">moved</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># I can remove the 3-way interaction</span></span>
<span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_0s</span> <span class="op">+</span> <span class="va">density_factor</span> <span class="op">+</span> <span class="va">moved</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># density x moved can be removed too</span></span>
<span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">moved</span> <span class="op">+</span>  </span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># density x SL</span></span>
<span><span class="va">c3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="va">SL_0s</span>  <span class="op">+</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">moved</span> <span class="op">+</span>  </span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># SL x moved</span></span>
<span><span class="va">c4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="va">SL_0s</span> <span class="op">+</span> <span class="va">density_factor</span> <span class="op">+</span> <span class="va">moved</span> <span class="op">+</span>  </span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># density</span></span>
<span><span class="va">c5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="va">SL_0s</span>  <span class="op">+</span> <span class="va">moved</span> <span class="op">+</span>  </span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># size</span></span>
<span><span class="va">c6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span>  <span class="va">moved</span> <span class="op">+</span>  </span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">c6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">## lmerModLmerTest]</span></span>
<span><span class="co">## Formula: cond_diff_30 ~ moved + (1 | marker_seq) + (1 | streamID)</span></span>
<span><span class="co">##    Data: cr_table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: -489.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.7823 -0.5085 -0.0766  0.5722  2.4954 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups     Name        Variance  Std.Dev.</span></span>
<span><span class="co">##  marker_seq (Intercept) 2.621e-06 0.001619</span></span>
<span><span class="co">##  streamID   (Intercept) 0.000e+00 0.000000</span></span>
<span><span class="co">##  Residual               9.006e-06 0.003001</span></span>
<span><span class="co">## Number of obs: 59, groups:  marker_seq, 4; streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##               Estimate Std. Error         df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  0.0036612  0.0009591  3.6081816   3.817 0.022737 *  </span></span>
<span><span class="co">## movedTRUE   -0.0033462  0.0008420 54.9251497  -3.974 0.000208 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##           (Intr)</span></span>
<span><span class="co">## movedTRUE -0.319</span></span>
<span><span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">c0</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">c1</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">c2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">c3</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">c4</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">c5</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">c6</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"lmerMod"</span></span>
<span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">c0</span>, <span class="va">c1</span>, <span class="va">c2</span>, <span class="va">c3</span>, <span class="va">c4</span>, <span class="va">c5</span>, <span class="va">c6</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"html"</span>, report <span class="op">=</span> <span class="op">(</span><span class="st">'vcp*'</span><span class="op">)</span>,</span>
<span>                     title  <span class="op">=</span> <span class="st">"Model selection (factorial treatments)"</span>,</span>
<span>                     dep.var.labels <span class="op">=</span> <span class="st">'Condition (mg/mm^3)'</span>,</span>
<span>                     column.sep.width <span class="op">=</span> <span class="st">"10pt"</span>,</span>
<span>                     omit.stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bic"</span><span class="op">)</span>,</span>
<span>                     star.char <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'.'</span>, <span class="st">'*'</span>, <span class="st">'**'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Model selection (factorial treatments)</strong>
</caption>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="7">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="7">
Condition (mg/mm
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
<td>
(5)
</td>
<td>
(6)
</td>
<td>
(7)
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s
</td>
<td>
-0.004
</td>
<td>
-0.004
</td>
<td>
-0.004
</td>
<td>
-0.004
</td>
<td>
-0.002
</td>
<td>
-0.002
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.011<sup>*</sup>
</td>
<td>
p = 0.011<sup>*</sup>
</td>
<td>
p = 0.008<sup>**</sup>
</td>
<td>
p = 0.006<sup>**</sup>
</td>
<td>
p = 0.065<sup>.</sup>
</td>
<td>
p = 0.062<sup>.</sup>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
density_factor
</td>
<td>
-0.001
</td>
<td>
-0.0002
</td>
<td>
0.0001
</td>
<td>
</td>
<td>
-0.001
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.702
</td>
<td>
p = 0.925
</td>
<td>
p = 0.965
</td>
<td>
</td>
<td>
p = 0.521
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
moved
</td>
<td>
-0.001
</td>
<td>
-0.001
</td>
<td>
-0.001
</td>
<td>
-0.001
</td>
<td>
-0.003
</td>
<td>
-0.003
</td>
<td>
-0.003
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.688
</td>
<td>
p = 0.540
</td>
<td>
p = 0.557
</td>
<td>
p = 0.507
</td>
<td>
p = 0.004<sup>**</sup>
</td>
<td>
p = 0.003<sup>**</sup>
</td>
<td>
p = 0.0001<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:density_factor
</td>
<td>
-0.003
</td>
<td>
-0.001
</td>
<td>
-0.001
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.547
</td>
<td>
p = 0.791
</td>
<td>
p = 0.830
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:moved
</td>
<td>
0.006
</td>
<td>
0.006
</td>
<td>
0.006
</td>
<td>
0.006
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.054<sup>.</sup>
</td>
<td>
p = 0.066<sup>.</sup>
</td>
<td>
p = 0.065<sup>.</sup>
</td>
<td>
p = 0.038<sup>*</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
density_factor:moved
</td>
<td>
0.002
</td>
<td>
0.001
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.561
</td>
<td>
p = 0.834
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:density_factor:moved
</td>
<td>
0.005
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.521
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.002
</td>
<td>
0.002
</td>
<td>
0.002
</td>
<td>
0.002
</td>
<td>
0.003
</td>
<td>
0.003
</td>
<td>
0.004
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.224
</td>
<td>
p = 0.230
</td>
<td>
p = 0.229
</td>
<td>
p = 0.181
</td>
<td>
p = 0.033<sup>*</sup>
</td>
<td>
p = 0.034<sup>*</sup>
</td>
<td>
p = 0.0002<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
59
</td>
<td>
59
</td>
<td>
59
</td>
<td>
59
</td>
<td>
59
</td>
<td>
59
</td>
<td>
59
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
218.514
</td>
<td>
222.217
</td>
<td>
227.129
</td>
<td>
237.428
</td>
<td>
234.792
</td>
<td>
240.326
</td>
<td>
244.525
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
-415.028
</td>
<td>
-424.434
</td>
<td>
-436.259
</td>
<td>
-460.856
</td>
<td>
-455.584
</td>
<td>
-468.653
</td>
<td>
-479.050
</td>
</tr>
<tr>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="7" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>The best model predicts condition differential to be most negative
when individuals disperse. This means that, on average, an individual is
more likely decrease in body condition if dispersing. The result makes
sense considering how costly dispersal can be. Moreover, large
individuals have smaller gains of condition, but not significantly. The
trend observed seems to be mostly determined by what happens in the
control treatment (very few datapoints all together).</p>
<p>Once again, we can run a model with treatment as a categorical
variable to check for asymmetries.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c0b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="va">SL_0s</span> <span class="op">*</span> <span class="va">treatment</span> <span class="op">*</span> <span class="va">moved</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="co"># here a bunch of interactions are significant</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">c0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">## lmerModLmerTest]</span></span>
<span><span class="co">## Formula: cond_diff_30 ~ SL_0s * treatment * moved + (1 | marker_seq) +  </span></span>
<span><span class="co">##     (1 | streamID)</span></span>
<span><span class="co">##    Data: cr_table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: -410.6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -1.70001 -0.57871 -0.06693  0.66484  2.07960 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups     Name        Variance  Std.Dev. </span></span>
<span><span class="co">##  marker_seq (Intercept) 2.962e-06 0.0017209</span></span>
<span><span class="co">##  streamID   (Intercept) 3.761e-07 0.0006133</span></span>
<span><span class="co">##  Residual               6.686e-06 0.0025858</span></span>
<span><span class="co">## Number of obs: 59, groups:  marker_seq, 4; streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                              Estimate Std. Error         df t value Pr(&gt;|t|)   </span></span>
<span><span class="co">## (Intercept)                 6.329e-04  1.721e-03  2.127e+01   0.368  0.71671   </span></span>
<span><span class="co">## SL_0s                      -6.897e-03  2.084e-03  4.436e+01  -3.309  0.00186 **</span></span>
<span><span class="co">## treatmentD                  1.186e-03  2.576e-03  4.311e+01   0.460  0.64764   </span></span>
<span><span class="co">## treatmentI                  1.939e-03  1.876e-03  4.500e+01   1.034  0.30685   </span></span>
<span><span class="co">## movedTRUE                   7.763e-05  2.344e-03  4.578e+01   0.033  0.97372   </span></span>
<span><span class="co">## SL_0s:treatmentD            6.466e-03  3.587e-03  4.361e+01   1.802  0.07838 . </span></span>
<span><span class="co">## SL_0s:treatmentI            7.509e-03  3.481e-03  4.448e+01   2.157  0.03644 * </span></span>
<span><span class="co">## SL_0s:movedTRUE             1.471e-02  5.619e-03  4.525e+01   2.617  0.01202 * </span></span>
<span><span class="co">## treatmentD:movedTRUE       -3.967e-04  3.475e-03  3.815e+01  -0.114  0.90971   </span></span>
<span><span class="co">## treatmentI:movedTRUE       -5.706e-04  3.169e-03  4.426e+01  -0.180  0.85794   </span></span>
<span><span class="co">## SL_0s:treatmentD:movedTRUE -1.639e-02  7.097e-03  4.481e+01  -2.309  0.02562 * </span></span>
<span><span class="co">## SL_0s:treatmentI:movedTRUE -1.258e-02  7.767e-03  4.406e+01  -1.620  0.11240   </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) SL_0s  trtmnD trtmnI mvTRUE SL_0s:D SL_0s:I SL_0:T tD:TRU</span></span>
<span><span class="co">## SL_0s        0.750                                                          </span></span>
<span><span class="co">## treatmentD  -0.401 -0.435                                                   </span></span>
<span><span class="co">## treatmentI  -0.641 -0.691  0.341                                            </span></span>
<span><span class="co">## movedTRUE   -0.539 -0.568  0.310  0.437                                     </span></span>
<span><span class="co">## SL_0s:trtmD -0.406 -0.549  0.862  0.354  0.322                              </span></span>
<span><span class="co">## SL_0s:trtmI -0.438 -0.569  0.248  0.811  0.265  0.298                       </span></span>
<span><span class="co">## SL_0s:mTRUE -0.330 -0.386  0.167  0.259  0.794  0.212   0.182               </span></span>
<span><span class="co">## trtmnD:TRUE  0.324  0.333 -0.756 -0.237 -0.653 -0.651  -0.150  -0.513       </span></span>
<span><span class="co">## trtmnI:TRUE  0.370  0.404 -0.223 -0.537 -0.711 -0.225  -0.422  -0.561  0.472</span></span>
<span><span class="co">## SL_0:D:TRUE  0.253  0.290 -0.438 -0.194 -0.612 -0.510  -0.139  -0.778  0.594</span></span>
<span><span class="co">## SL_0:I:TRUE  0.211  0.257 -0.120 -0.345 -0.530 -0.135  -0.421  -0.688  0.358</span></span>
<span><span class="co">##             tI:TRU SL_0:D:</span></span>
<span><span class="co">## SL_0s                     </span></span>
<span><span class="co">## treatmentD                </span></span>
<span><span class="co">## treatmentI                </span></span>
<span><span class="co">## movedTRUE                 </span></span>
<span><span class="co">## SL_0s:trtmD               </span></span>
<span><span class="co">## SL_0s:trtmI               </span></span>
<span><span class="co">## SL_0s:mTRUE               </span></span>
<span><span class="co">## trtmnD:TRUE               </span></span>
<span><span class="co">## trtmnI:TRUE               </span></span>
<span><span class="co">## SL_0:D:TRUE  0.421        </span></span>
<span><span class="co">## SL_0:I:TRUE  0.815  0.527</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">c3</span>, <span class="va">c0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     df       AIC</span></span>
<span><span class="co">## c3   7 -460.8564</span></span>
<span><span class="co">## c0b 15 -380.5707</span></span></code></pre>
<p>The factorial treatment shows different results. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>AIC
between the two models is quite drastic (&gt; 80), and the model with
density as a continuous provides a better fit.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cr_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">moved</span>, </span>
<span>                            y <span class="op">=</span> <span class="va">cond_diff_30</span>,</span>
<span>                            fill <span class="op">=</span> <span class="va">moved</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>coef <span class="op">=</span> <span class="fl">0</span>,</span>
<span>               outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Dispersal"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Relative change in condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>, <span class="fl">0.015</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">21</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NO"</span>, <span class="st">"YES"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#fa8775"</span>, <span class="st">"#9d02d7"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">0.013</span>, yend <span class="op">=</span> <span class="fl">0.013</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="fl">0.0135</span>, label <span class="op">=</span> <span class="st">"*"</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                           <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdp</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 302 rows containing non-finite outside the scale range</span></span>
<span><span class="co">## (`stat_boxplot()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 302 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># jpeg(file.path(here::here(), "vignettes", "condition_dispersal.jpeg"),</span></span>
<span><span class="co">#      width = 3, height = 3.5, units = "in", res = 400)</span></span>
<span><span class="co"># cdp</span></span>
<span><span class="co"># dev.off()</span></span></code></pre></div>
<p>Below we plot the results when treatment is considered as a factor
(model that was discarded according to AIC values).</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata_cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>SL_0 <span class="op">=</span> <span class="va">sls</span>,</span>
<span>                            treatment <span class="op">=</span> <span class="va">tts</span>,</span>
<span>                            moved <span class="op">=</span> <span class="va">mv</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SL_0s <span class="op">=</span> <span class="op">(</span><span class="va">SL_0</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:center"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:scale"</span><span class="op">)</span>,</span>
<span>         moved <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>         treatment_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>c_pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">c0b</span>, newdata <span class="op">=</span> <span class="va">.</span>, re.form <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex_stage_1</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, y <span class="op">=</span> <span class="va">cond_diff_30</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"Change in condition ("</span> <span class="op">~</span> <span class="va">mm</span><span class="op">/</span><span class="va">mg</span><span class="op">^</span><span class="fl">3</span><span class="op">~</span><span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Initial standard length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">streamID</span>, shape <span class="op">=</span> <span class="va">moved</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#DAA323"</span>, <span class="st">"#691E92"</span>, <span class="st">"#199958"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">newdata_cond</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, y <span class="op">=</span> <span class="va">c_pred</span>, linetype <span class="op">=</span> <span class="va">moved</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">treatment_f</span>, </span>
<span>              labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>treatment_f <span class="op">=</span> <span class="va">labelss_treat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Effect of density and dispersal on condition"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/annotate_figure.html" class="external-link">annotate_figure</a></span><span class="op">(</span><span class="va">p</span>, top <span class="op">=</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/text_grob.html" class="external-link">text_grob</a></span><span class="op">(</span><span class="st">"This  model  was  rejected (Delta AIC &gt;&gt; 4)"</span>,</span>
<span>                                   color <span class="op">=</span> <span class="st">"red"</span>, vjust <span class="op">=</span> <span class="fl">7</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 186 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 58 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_line()`).</span></span></code></pre>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>In order to prove that dispersal decreases condition, and not that
individual of lower condition disperse, we will run here a model where
<em>initial</em> condition is the explanatory variable, and dispersal
the response.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first, I am testing whether initial condition affects dispersal</span></span>
<span><span class="va">c_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">condition_0</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_0</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>             data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>             family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>             na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">c_d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span><span class="co">##   Approximation) [glmerMod]</span></span>
<span><span class="co">##  Family: binomial  ( logit )</span></span>
<span><span class="co">## Formula: moved ~ condition_0 + (1 | marker_0) + (1 | streamID)</span></span>
<span><span class="co">##    Data: cr_table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">##    138.3    149.2    -65.1    130.3      109 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.3678 -0.7174 -0.5020  0.9908  5.4232 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  streamID (Intercept) 0        0       </span></span>
<span><span class="co">##  marker_0 (Intercept) 0        0       </span></span>
<span><span class="co">## Number of obs: 113, groups:  streamID, 3; marker_0, 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span><span class="co">## (Intercept)   -5.543      1.714  -3.234  0.00122 **</span></span>
<span><span class="co">## condition_0  277.980     95.868   2.900  0.00374 **</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr)</span></span>
<span><span class="co">## condition_0 -0.992</span></span>
<span><span class="co">## optimizer (Nelder_Mead) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<p>We tried a model with the interaction between <code>sex_stage</code>
and condition, and the interaction was not significant. We already know
males are more likely to disperse than immature individuals, so there is
no need to keep sex as a fixed effect.</p>
<p>Initial condition significantly affects dispersal, with individuals
in good condition more likely to disperse.</p>
<p>Let’s now see if dispersal affects final condition.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">condition_1</span> <span class="op">~</span> <span class="va">moved</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_0</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">d_c</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">## lmerModLmerTest]</span></span>
<span><span class="co">## Formula: condition_1 ~ moved + (1 | marker_0) + (1 | streamID)</span></span>
<span><span class="co">##    Data: cr_table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: -592.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -2.95123 -0.62091 -0.04051  0.49032  2.42803 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance  Std.Dev. </span></span>
<span><span class="co">##  streamID (Intercept) 5.087e-07 0.0007132</span></span>
<span><span class="co">##  marker_0 (Intercept) 0.000e+00 0.0000000</span></span>
<span><span class="co">##  Residual             2.570e-06 0.0016033</span></span>
<span><span class="co">## Number of obs: 62, groups:  streamID, 3; marker_0, 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##               Estimate Std. Error         df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  0.0200976  0.0004906  2.5829428  40.968 0.000105 ***</span></span>
<span><span class="co">## movedTRUE   -0.0009452  0.0004304 58.2300173  -2.196 0.032094 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##           (Intr)</span></span>
<span><span class="co">## movedTRUE -0.297</span></span>
<span><span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<p>We tested for an interaction between moved and initial condition, and
for the main effect of initial condition, and these were not significant
(not even when initial condition is alone in the model). Density also
did not have a significant effect on condition. Dispersal has a
significant and negative effect on final condition.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>condition_0 <span class="op">=</span> <span class="fu">modelr</span><span class="fu">::</span><span class="fu"><a href="https://modelr.tidyverse.org/reference/seq_range.html" class="external-link">seq_range</a></span><span class="op">(</span><span class="va">cr_table</span><span class="op">$</span><span class="va">condition_0</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">c_d</span>, newdata <span class="op">=</span> <span class="va">.</span>, re.form <span class="op">=</span> <span class="op">~</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c_dplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">cr_table</span>, </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition_0</span>, </span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">moved</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">conds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition_0</span>, y <span class="op">=</span> <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"Initial condition ("</span><span class="op">~</span><span class="va">mm</span><span class="op">/</span><span class="va">mg</span><span class="op">^</span><span class="fl">3</span><span class="op">~</span><span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Dispersal probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_cplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cr_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">moved</span>, y <span class="op">=</span> <span class="va">condition_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>coef <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0.012</span>, <span class="fl">0.026</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"Final condition ("</span><span class="op">~</span><span class="va">mm</span><span class="op">/</span><span class="va">mg</span><span class="op">^</span><span class="fl">3</span><span class="op">~</span><span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Dispersed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">0.025</span>, yend <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1.5</span>, y <span class="op">=</span> <span class="fl">0.0255</span>, label <span class="op">=</span> <span class="st">"*"</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">c_dplot</span>, <span class="va">d_cplot</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 248 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning in geom_segment(aes(x = 1, xend = 2, y = 0.025, yend = 0.025)): All aesthetics have length 1, but the data has 361 rows.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">##   a single row.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 282 rows containing non-finite outside the scale range</span></span>
<span><span class="co">## (`stat_boxplot()`).</span></span></code></pre>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plotting change in condition with dispersal and effect of initial condition on dispersal</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">cdp</span>, <span class="va">c_dplot</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 302 rows containing non-finite outside the scale range</span></span>
<span><span class="co">## (`stat_boxplot()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 302 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 248 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-20-2.png" width="700"></p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">jpeg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"figures"</span>, <span class="st">"condition_by_dispersal.jpeg"</span><span class="op">)</span>,</span>
<span>     width <span class="op">=</span> <span class="fl">6</span>, height <span class="op">=</span> <span class="fl">3.5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">cdp</span>, <span class="va">c_dplot</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 302 rows containing non-finite outside the scale range</span></span>
<span><span class="co">## (`stat_boxplot()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 302 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 248 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="condition-habitat-change">Condition &amp; Habitat change<a class="anchor" aria-label="anchor" href="#condition-habitat-change"></a>
</h3>
<p>For condition too, as we did for growth, we could run a model to
observe the short-term effects of habitat change for the individuals who
did not disperse.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ch0</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="va">density_factor</span><span class="op">*</span><span class="va">hshift</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ch0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">## lmerModLmerTest]</span></span>
<span><span class="co">## Formula: cond_diff_30 ~ density_factor * hshift + (1 | marker_seq) + (1 |  </span></span>
<span><span class="co">##     streamID)</span></span>
<span><span class="co">##    Data: cr_table %&gt;% filter(!moved)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: -295.4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.8682 -0.5988 -0.1030  0.4259  2.4104 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups     Name        Variance  Std.Dev. </span></span>
<span><span class="co">##  marker_seq (Intercept) 5.044e-06 2.246e-03</span></span>
<span><span class="co">##  streamID   (Intercept) 1.799e-15 4.241e-08</span></span>
<span><span class="co">##  Residual               9.096e-06 3.016e-03</span></span>
<span><span class="co">## Number of obs: 39, groups:  marker_seq, 4; streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                             Estimate Std. Error         df t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept)                0.0044640  0.0014048  4.4292973   3.178   0.0291 *</span></span>
<span><span class="co">## density_factor             0.0023963  0.0025134 33.0538726   0.953   0.3473  </span></span>
<span><span class="co">## hshiftTRUE                -0.0003129  0.0011419 32.3394696  -0.274   0.7858  </span></span>
<span><span class="co">## density_factor:hshiftTRUE -0.0069605  0.0036671 32.7694319  -1.898   0.0665 .</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) dnsty_ hsTRUE</span></span>
<span><span class="co">## densty_fctr  0.184              </span></span>
<span><span class="co">## hshiftTRUE  -0.395 -0.298       </span></span>
<span><span class="co">## dnsty_:TRUE -0.166 -0.633 -0.121</span></span>
<span><span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3-way is not significant and there's too few datapoints.</span></span>
<span><span class="va">ch0b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmerTest/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">cond_diff_30</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_0s</span> <span class="op">+</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">hshift</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>                   <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">marker_seq</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>                 na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ch0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span></span>
<span><span class="co">## lmerModLmerTest]</span></span>
<span><span class="co">## Formula: cond_diff_30 ~ (SL_0s + treatment + hshift)^2 + (1 | marker_seq) +  </span></span>
<span><span class="co">##     (1 | streamID)</span></span>
<span><span class="co">##    Data: cr_table %&gt;% filter(!moved)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## REML criterion at convergence: -257.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -1.38934 -0.54046  0.06346  0.32927  2.26504 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups     Name        Variance  Std.Dev.</span></span>
<span><span class="co">##  marker_seq (Intercept) 6.120e-06 0.002474</span></span>
<span><span class="co">##  streamID   (Intercept) 0.000e+00 0.000000</span></span>
<span><span class="co">##  Residual               5.107e-06 0.002260</span></span>
<span><span class="co">## Number of obs: 39, groups:  marker_seq, 4; streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                        Estimate Std. Error        df t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)           -0.006871   0.003176 26.969424  -2.163  0.03954 *  </span></span>
<span><span class="co">## SL_0s                 -0.017661   0.004311 26.626882  -4.097  0.00035 ***</span></span>
<span><span class="co">## treatmentD             0.008366   0.003375 26.065258   2.479  0.01998 *  </span></span>
<span><span class="co">## treatmentI             0.009081   0.002759 26.189681   3.291  0.00285 ** </span></span>
<span><span class="co">## hshiftTRUE             0.009188   0.003013 26.145689   3.049  0.00520 ** </span></span>
<span><span class="co">## SL_0s:treatmentD       0.015661   0.005327 26.409273   2.940  0.00674 ** </span></span>
<span><span class="co">## SL_0s:treatmentI       0.005148   0.003229 26.876563   1.594  0.12253    </span></span>
<span><span class="co">## SL_0s:hshiftTRUE       0.013378   0.004535 26.471650   2.950  0.00657 ** </span></span>
<span><span class="co">## treatmentD:hshiftTRUE  0.001341   0.004181 27.356815   0.321  0.75088    </span></span>
<span><span class="co">## treatmentI:hshiftTRUE -0.009318   0.002935 26.439576  -3.175  0.00379 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) SL_0s  trtmnD trtmnI hsTRUE SL_0:D SL_0:I SL_0:T tD:TRU</span></span>
<span><span class="co">## SL_0s        0.892                                                        </span></span>
<span><span class="co">## treatmentD  -0.736 -0.778                                                 </span></span>
<span><span class="co">## treatmentI  -0.719 -0.742  0.639                                          </span></span>
<span><span class="co">## hshiftTRUE  -0.815 -0.858  0.736  0.662                                   </span></span>
<span><span class="co">## SL_0s:trtmD -0.722 -0.809  0.916  0.601  0.695                            </span></span>
<span><span class="co">## SL_0s:trtmI -0.141 -0.155  0.110  0.275 -0.084  0.125                     </span></span>
<span><span class="co">## SL_0s:hTRUE -0.807 -0.907  0.712  0.623  0.939  0.734 -0.078              </span></span>
<span><span class="co">## trtmnD:TRUE -0.434 -0.518  0.463  0.296  0.422  0.665  0.034  0.559       </span></span>
<span><span class="co">## trtmnI:TRUE  0.554  0.569 -0.528 -0.776 -0.728 -0.461  0.258 -0.624 -0.180</span></span>
<span><span class="co">## optimizer (nloptwrap) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">ch0</span>, <span class="va">ch0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      df       AIC</span></span>
<span><span class="co">## ch0   7 -281.4055</span></span>
<span><span class="co">## ch0b 13 -231.1079</span></span></code></pre>
<p>The models differ between density as a continuous and as a factor,
but the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>AIC
is large enough that we can pick one. The former is a better fit model,
so we will consider that.</p>
<p>The only significant term is the interaction between density and
habitat shift.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">labelss_hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"SAME HABITAT"</span>,</span>
<span>                   <span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"CHANGED HABITAT"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cr_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">hshift</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">density_factor</span>, y <span class="op">=</span> <span class="va">cond_diff_30</span>, colour <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"difference in condition (mm)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"density multiplier"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>shape<span class="op">=</span><span class="fl">16</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">hshift</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>hshift <span class="op">=</span> <span class="va">labelss_hab</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Effect of density and habitat change on condition"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chp</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 246 rows containing non-finite outside the scale range</span></span>
<span><span class="co">## (`stat_boxplot()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 246 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>These results are intentionally left out of the paper, since the
number of analyses is already limiting in reducing the scope of the
study to a clear message.</p>
</div>
</div>
<div class="section level2">
<h2 id="pool-level-recruitment">Pool-level Recruitment<a class="anchor" aria-label="anchor" href="#pool-level-recruitment"></a>
</h2>
<p>The data for female reproductive allocation published in this study.
As a proxy we can look at the recruitment at the pool-level, as the
number of newborn (&lt;10 mm) recruited by a given number of adults.
This will not give much information on female reproductive output (since
the time between capture and recapture will seldom be enough for a
female to get pregnant and produce offspring), but rather will give an
idea of early-life mortality.</p>
<p>We will calculate the number of adults that were captured in the
“control”, “decreased” and “increased” pool, and the number of babies in
the same pools, to establish the equilibrium “recruitment” as the
proportion of babies per adult in the pool. In each pool, the
recruitment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mfrac><msub><mi>r</mi><mrow><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><msub><mi>a</mi><mrow><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">R_0 = \frac{r_{captured}}{a_{captured}}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mrow><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">r_{captured}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">a_{captured}</annotation></semantics></math>
correspond to the number of new recruits (individuals &lt; 10 mm) and
adults captured in the pool during the first capture, respectively.</p>
<p>We will then calculate the same recruitment proxy after the
experiment
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>1</mn></msub><annotation encoding="application/x-tex">R_1</annotation></semantics></math>)
as the ratio between the number of the number of new recruits (&lt; 10
mm) <em>recaptured</em> after the experiment ended
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mrow><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">r_{recaptured}</annotation></semantics></math>)
and the number of adults <em>released</em> in the pools as part of the
experimental density manipulation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mrow><mi>r</mi><mi>e</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">a_{released}</annotation></semantics></math>).
This excludes the individuals removed from the decreased pool, and
includes the extra-limital individuals added to the increased pool.</p>
<p>Note: while calculating the standard error for the difference in
recruitment, we’ll have to make a few assumptions, since the sample in
this case is a single number. In order to calculate the variance of the
difference in recruitment, defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>r</mi><mrow><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><msub><mi>a</mi><mrow><mi>r</mi><mi>e</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>d</mi></mrow></msub></mfrac><mo>−</mo><mfrac><msub><mi>r</mi><mrow><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><msub><mi>a</mi><mrow><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Var(R_1 - R_0) = Var(\frac{r_{recaptured}}{a_{released}} - \frac{r_{captured}}{a_{captured}})</annotation></semantics></math>
We will need to assume the covariance between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>1</mn></msub><annotation encoding="application/x-tex">R_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
to be 0, since both are estimated as a single ratio. If we do so,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo>−</mo><msub><mi>R</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Var(R_1 - R_0) \approx Var(R_1) + Var(R_0)
</annotation></semantics></math></p>
<p>In addition, we will use the Delta approximation to calculate
variance, as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>r</mi><mi>a</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mfrac><mn>1</mn><msup><mi>a</mi><mn>2</mn></msup></mfrac><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><msup><mi>a</mi><mn>2</mn></msup><msup><mi>r</mi><mn>4</mn></msup></mfrac><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Var(R) = Var(\frac{r}{a}) \approx \frac{1}{a^2} Var(r) + \frac{a^2}{r^4}Var(a)
</annotation></semantics></math> A third assumption is that the count
data (number of recruits and number of adults) will be Poisson
distributed, making</p>
<p><span class="math display">$$
Var(r) = E(r)\newline
Var(a) = E(a)
$$</span></p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recruits</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># only manipulated streams</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">streamID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CL1"</span>, <span class="st">"CL2"</span>, <span class="st">"TL"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">streamID</span>, <span class="va">patchID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># we include all individuals captured in a given pool in the accounting of initial recruitment</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>adults_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">isbabyMark</span> <span class="op">&amp;</span> <span class="va">recap</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> </span>
<span>                             <span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>, <span class="st">"R"</span>, <span class="st">"XR"</span>, <span class="st">"X"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            babies_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">isbabyMark</span> <span class="op">&amp;</span> <span class="va">recap</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> </span>
<span>                             <span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>, <span class="st">"R"</span>, <span class="st">"XR"</span>, <span class="st">"X"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            adults_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">isbabyMark</span> <span class="op">&amp;</span> <span class="va">recap</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            babies_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">isbabyMark</span> <span class="op">&amp;</span> <span class="va">recap</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">patchID</span><span class="op">)</span>, <span class="va">adults_0</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'streamID'. You can override using the</span></span>
<span><span class="co">## `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the increased density pools are missing the added extralimital individuals</span></span>
<span><span class="co"># first, I will assign to each pool its treatment</span></span>
<span><span class="va">patch_to_treat</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">recap</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">streamID</span>, <span class="va">patchID</span>, <span class="va">treatment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">summarise</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'streamID', 'patchID'. You can override</span></span>
<span><span class="co">## using the `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># I can now add the treatment info to the recruits table</span></span>
<span><span class="va">recruits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">patch_to_treat</span>, <span class="va">recruits</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(streamID, patchID)`</span></span></code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Now, I can count how many adults were added to the increased pool in each stream</span></span>
<span><span class="va">introduced</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"E"</span>, <span class="op">!</span><span class="va">isbabyMark</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">streamID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>introduced <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now I can merge this, and add the individuals to the introduced pool</span></span>
<span><span class="co"># then I can calculate the proportional recruitment</span></span>
<span><span class="co"># and the error</span></span>
<span><span class="va">recruits</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">introduced</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>adults_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"I"</span>, <span class="va">adults_1</span> <span class="op">+</span> <span class="va">introduced</span>, <span class="va">adults_1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">introduced</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>recruit_0 <span class="op">=</span> <span class="va">babies_0</span><span class="op">/</span><span class="va">adults_0</span>,</span>
<span>         recruit_1 <span class="op">=</span> <span class="va">babies_1</span><span class="op">/</span><span class="va">adults_1</span>,</span>
<span>         recruit_0_var <span class="op">=</span> <span class="va">babies_0</span><span class="op">/</span><span class="op">(</span><span class="va">adults_0</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">babies_0</span><span class="op">/</span><span class="op">(</span><span class="va">adults_0</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>         recruit_1_var <span class="op">=</span> <span class="va">babies_1</span><span class="op">/</span><span class="op">(</span><span class="va">adults_1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">babies_1</span><span class="op">/</span><span class="op">(</span><span class="va">adults_1</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>         SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">recruit_1_var</span> <span class="op">+</span> <span class="va">recruit_0_var</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(streamID)`</span></span></code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># last step, including the information on density as continuous factor</span></span>
<span><span class="co"># instead of categorical variables</span></span>
<span><span class="va">recruits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">treatment_tab</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">patchID</span><span class="op">)</span>,<span class="va">recruits</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">streamID</span>, <span class="va">density_factor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="va">treatment</span>,</span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span> <span class="op">=</span> <span class="st">"decreased"</span>,</span>
<span>                                   <span class="st">"C"</span> <span class="op">=</span> <span class="st">"control"</span>,</span>
<span>                                   <span class="st">"I"</span> <span class="op">=</span> <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decreased"</span>, <span class="st">"control"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         stream <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">streamID</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CL1"</span>, <span class="st">"CL2"</span>, <span class="st">"TL"</span><span class="op">)</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Caigual 1"</span>, <span class="st">"Caigual 2"</span>, <span class="st">"Taylor"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         <span class="co"># recentering the density factor</span></span>
<span>         density_factor <span class="op">=</span> <span class="va">density_factor</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(streamID, treatment)`</span></span></code></pre>
<p>We can now plot to visualize the proportional recruitment before and
after, in the different treatments. Keep in mind that “recruitment” here
is simply the ratio between individuals &lt;10 mm and adult
individuals.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">recruits</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">density_factor</span>, </span>
<span>                 y <span class="op">=</span> <span class="va">recruit_1</span> <span class="op">-</span> <span class="va">recruit_0</span>, </span>
<span>                 group <span class="op">=</span> <span class="va">stream</span>,</span>
<span>                 color <span class="op">=</span> <span class="va">stream</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">stream</span><span class="op">)</span>, </span>
<span>             size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">stream</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">recruit_1</span> <span class="op">-</span> <span class="va">recruit_0</span> <span class="op">-</span> <span class="va">SE</span>, ymax <span class="op">=</span> <span class="va">recruit_1</span> <span class="op">-</span> <span class="va">recruit_0</span> <span class="op">+</span> <span class="va">SE</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>                position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#DAA323"</span>, <span class="st">"#691E92"</span>, <span class="st">"#199958"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Recruitment difference (± SE)"</span>, x <span class="op">=</span> <span class="st">"Poportional change in density"</span>, </span>
<span>       color <span class="op">=</span> <span class="st">"Stream"</span>, linetype <span class="op">=</span> <span class="st">"Stream"</span>, shape <span class="op">=</span> <span class="st">"Stream"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pr</span></span></code></pre></div>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">jpeg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"figures"</span>, <span class="st">"pool_level_recruitment.jpeg"</span><span class="op">)</span>,</span>
<span>     width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">3.5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">pr</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
<p>An important comment is to be made here: as stated above, the number
of babies at the recapture is divided by the number of adults
<strong>released</strong> during capture. This is not necessarily equal
to the number of adults recaptured, since some individual might have
left the habitat patch, dispersing away. This was done to avoid
confounding two things: the effects of density in terms of dispersal
(more individuals might trigger more dispersal) and the effects of
density on recruitment.</p>
<p>We can run here a very simple model to see if the trend is
significant (despite having very few datapoints).</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r_model0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">recruit_1</span> <span class="op">-</span> <span class="va">recruit_0</span><span class="op">)</span> <span class="op">~</span> <span class="va">density_factor</span>, data <span class="op">=</span> <span class="va">recruits</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = I(recruit_1 - recruit_0) ~ density_factor, data = recruits)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.18549 -0.07923 -0.03814  0.06001  0.34895 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept)     0.03165    0.05498   0.576   0.5829  </span></span>
<span><span class="co">## density_factor -0.47197    0.13782  -3.424   0.0111 *</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1648 on 7 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.6262, Adjusted R-squared:  0.5728 </span></span>
<span><span class="co">## F-statistic: 11.73 on 1 and 7 DF,  p-value: 0.01107</span></span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">r_model0b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">recruit_1</span> <span class="op">-</span> <span class="va">recruit_0</span><span class="op">)</span> <span class="op">~</span> <span class="va">treatment</span>, data <span class="op">=</span> <span class="va">recruits</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = I(recruit_1 - recruit_0) ~ treatment, data = recruits)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.20721 -0.07615 -0.02172  0.03025  0.32724 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                    Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept)          0.2576     0.1048   2.459   0.0492 *</span></span>
<span><span class="co">## treatmentcontrol    -0.2043     0.1482  -1.378   0.2173  </span></span>
<span><span class="co">## treatmentincreased  -0.4548     0.1482  -3.069   0.0220 *</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1815 on 6 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.6117, Adjusted R-squared:  0.4823 </span></span>
<span><span class="co">## F-statistic: 4.726 on 2 and 6 DF,  p-value: 0.05855</span></span></code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">r_model0</span>, <span class="va">r_model0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           df       AIC</span></span>
<span><span class="co">## r_model0   3 -3.170154</span></span>
<span><span class="co">## r_model0b  4 -0.827568</span></span></code></pre>
<p>Recruitment is significantly lower at higher density, as we would
expect.</p>
</div>
<div class="section level2">
<h2 id="survival">Survival<a class="anchor" aria-label="anchor" href="#survival"></a>
</h2>
<p>The last trait we can look at is Survival. We can approximate
survival calculating recapture rate of individuals released.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first, we need a fresh and unmodified version of the cr_table</span></span>
<span><span class="va">cr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"DME_cr_data.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># I also need to revise the treatment table so treatment "E" can be assigned to</span></span>
<span><span class="co"># a density factor value</span></span>
<span><span class="va">treatment_surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">treatment_tab</span>,</span>
<span>                        <span class="va">treatment_tab</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                          <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="st">"E"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">patchID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>pool_density <span class="op">=</span> <span class="va">density_factor</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="co"># subsetting for individuals released after first capture</span></span>
<span><span class="co"># creating variable for recaptured or not</span></span>
<span><span class="va">released</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">recap</span> <span class="op">==</span> <span class="fl">0</span>, <span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>, <span class="st">"E"</span><span class="op">)</span>,</span>
<span>         <span class="op">!</span><span class="va">isbabyMark</span>, <span class="op">!</span><span class="va">isCohort</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>recaptured <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">markID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cr</span><span class="op">$</span><span class="va">markID</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         SL_s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">SL</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         pool_treatment <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">treatment</span>,</span>
<span>                                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>, <span class="st">"E"</span><span class="op">)</span>,</span>
<span>                                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"decreased"</span>, <span class="st">"increased"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         sex_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex_stage</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"I"</span>, <span class="st">"M"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># adding density as a continuous</span></span>
<span><span class="va">released</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">treatment_surv</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pool_density <span class="op">=</span> <span class="va">pool_density</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(streamID, treatment)`</span></span></code></pre>
<p>Now we can analyse survival probability based on density (including
size and sex). I can adopt the same procedure as before, running the
model twice and using density both as a factor and as a continuous
value.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">recaptured</span> <span class="op">~</span> <span class="va">SL_s</span><span class="op">*</span><span class="va">sex_stage</span><span class="op">*</span><span class="va">pool_density</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>           family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>           data <span class="op">=</span> <span class="va">released</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">recaptured</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_s</span><span class="op">+</span><span class="va">sex_stage</span><span class="op">+</span><span class="va">pool_density</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>           family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>           data <span class="op">=</span> <span class="va">released</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">recaptured</span> <span class="op">~</span> <span class="va">SL_s</span><span class="op">*</span><span class="va">sex_stage</span><span class="op">+</span><span class="va">sex_stage</span><span class="op">*</span><span class="va">pool_density</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>           family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>           data <span class="op">=</span> <span class="va">released</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span><span class="co">##   Approximation) [glmerMod]</span></span>
<span><span class="co">##  Family: binomial  ( logit )</span></span>
<span><span class="co">## Formula: recaptured ~ SL_s * sex_stage + sex_stage * pool_density + (1 |  </span></span>
<span><span class="co">##     streamID)</span></span>
<span><span class="co">##    Data: released</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">##    780.3    824.4   -380.1    760.3      601 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.4054 -1.0387  0.5613  0.7675  2.9081 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  streamID (Intercept) 0        0       </span></span>
<span><span class="co">## Number of obs: 611, groups:  streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                         Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)               1.0742     0.1616   6.649 2.96e-11 ***</span></span>
<span><span class="co">## SL_s                     -0.3082     0.1256  -2.454  0.01414 *  </span></span>
<span><span class="co">## sex_stageI               -0.9292     0.3788  -2.453  0.01418 *  </span></span>
<span><span class="co">## sex_stageM               -2.5317     0.3922  -6.455 1.08e-10 ***</span></span>
<span><span class="co">## pool_density             -1.2130     0.3860  -3.143  0.00167 ** </span></span>
<span><span class="co">## SL_s:sex_stageI          -0.1030     0.3471  -0.297  0.76664    </span></span>
<span><span class="co">## SL_s:sex_stageM          -1.3844     0.6474  -2.138  0.03249 *  </span></span>
<span><span class="co">## sex_stageI:pool_density   0.7549     0.6378   1.184  0.23661    </span></span>
<span><span class="co">## sex_stageM:pool_density   2.2887     0.7321   3.126  0.00177 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) SL_s   sx_stI sx_stM pl_dns SL_:_I SL_:_M sx_I:_</span></span>
<span><span class="co">## SL_s        -0.543                                                 </span></span>
<span><span class="co">## sex_stageI  -0.426  0.232                                          </span></span>
<span><span class="co">## sex_stageM  -0.412  0.224  0.176                                   </span></span>
<span><span class="co">## pool_densty -0.500  0.169  0.213  0.206                            </span></span>
<span><span class="co">## SL_s:sx_stI  0.197 -0.362  0.639 -0.081 -0.061                     </span></span>
<span><span class="co">## SL_s:sx_stM  0.105 -0.194 -0.045  0.624 -0.033  0.070              </span></span>
<span><span class="co">## sx_stgI:pl_  0.302 -0.102 -0.327 -0.125 -0.605 -0.075  0.020       </span></span>
<span><span class="co">## sx_stgM:pl_  0.264 -0.089 -0.112 -0.419 -0.527  0.032 -0.023  0.319</span></span>
<span><span class="co">## optimizer (Nelder_Mead) convergence code: 0 (OK)</span></span>
<span><span class="co">## boundary (singular) fit: see help('isSingular')</span></span></code></pre>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># LRT</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s0</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Data: released</span></span>
<span><span class="co">## Models:</span></span>
<span><span class="co">## s1: recaptured ~ (SL_s + sex_stage + pool_density)^2 + (1 | streamID)</span></span>
<span><span class="co">## s0: recaptured ~ SL_s * sex_stage * pool_density + (1 | streamID)</span></span>
<span><span class="co">##    npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)</span></span>
<span><span class="co">## s1   11 781.23 829.80 -379.62   759.23                     </span></span>
<span><span class="co">## s0   13 781.94 839.33 -377.97   755.94 3.2959  2     0.1924</span></span></code></pre>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s0b</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">recaptured</span> <span class="op">~</span> <span class="va">SL_s</span><span class="op">*</span><span class="va">sex_stage</span><span class="op">+</span><span class="va">sex_stage</span><span class="op">*</span><span class="va">pool_treatment</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">location</span><span class="op">)</span>,</span>
<span>           family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>           data <span class="op">=</span> <span class="va">released</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span><span class="co">##   Approximation) [glmerMod]</span></span>
<span><span class="co">##  Family: binomial  ( logit )</span></span>
<span><span class="co">## Formula: recaptured ~ SL_s * sex_stage + sex_stage * pool_treatment +  </span></span>
<span><span class="co">##     (1 | location)</span></span>
<span><span class="co">##    Data: released</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">##    782.9    840.3   -378.4    756.9      598 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.2323 -0.9932  0.5428  0.7612  3.1104 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  location (Intercept) 0.01717  0.131   </span></span>
<span><span class="co">## Number of obs: 611, groups:  location, 12</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                                    Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)                         1.22151    0.22233   5.494 3.93e-08 ***</span></span>
<span><span class="co">## SL_s                               -0.29292    0.12666  -2.313  0.02074 *  </span></span>
<span><span class="co">## sex_stageI                         -0.85998    0.48240  -1.783  0.07463 .  </span></span>
<span><span class="co">## sex_stageM                         -2.84080    0.51683  -5.497 3.87e-08 ***</span></span>
<span><span class="co">## pool_treatmentdecreased             0.22732    0.43536   0.522  0.60157    </span></span>
<span><span class="co">## pool_treatmentincreased            -0.75777    0.27676  -2.738  0.00618 ** </span></span>
<span><span class="co">## SL_s:sex_stageI                    -0.03964    0.35788  -0.111  0.91180    </span></span>
<span><span class="co">## SL_s:sex_stageM                    -1.42080    0.65921  -2.155  0.03114 *  </span></span>
<span><span class="co">## sex_stageI:pool_treatmentdecreased -0.15972    0.66142  -0.241  0.80919    </span></span>
<span><span class="co">## sex_stageM:pool_treatmentdecreased -0.63987    0.86628  -0.739  0.46012    </span></span>
<span><span class="co">## sex_stageI:pool_treatmentincreased  0.34335    0.46348   0.741  0.45881    </span></span>
<span><span class="co">## sex_stageM:pool_treatmentincreased  1.43144    0.51876   2.759  0.00579 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##                    (Intr) SL_s   sx_stI sx_stM pl_trtmntd pl_trtmntn SL_:_I</span></span>
<span><span class="co">## SL_s               -0.348                                                  </span></span>
<span><span class="co">## sex_stageI         -0.399  0.157                                           </span></span>
<span><span class="co">## sex_stageM         -0.372  0.145  0.174                                    </span></span>
<span><span class="co">## pl_trtmntdc        -0.391 -0.159  0.152  0.143                             </span></span>
<span><span class="co">## pl_trtmntnc        -0.726  0.046  0.282  0.262  0.351                      </span></span>
<span><span class="co">## SL_s:sx_stI         0.124 -0.352  0.609 -0.049  0.057     -0.020           </span></span>
<span><span class="co">## SL_s:sx_stM         0.071 -0.194 -0.027  0.536  0.032     -0.019      0.073</span></span>
<span><span class="co">## sx_stgI:pl_trtmntd  0.216  0.109 -0.337 -0.093 -0.617     -0.199     -0.052</span></span>
<span><span class="co">## sx_stgM:pl_trtmntd  0.165  0.083 -0.075 -0.389 -0.471     -0.152     -0.028</span></span>
<span><span class="co">## sx_stgI:pl_trtmntn  0.379 -0.028 -0.645 -0.154 -0.181     -0.518     -0.188</span></span>
<span><span class="co">## sx_stgM:pl_trtmntn  0.325 -0.018 -0.153 -0.707 -0.162     -0.443      0.006</span></span>
<span><span class="co">##                    SL_:_M sx_stgI:pl_trtmntd sx_stgM:pl_trtmntd</span></span>
<span><span class="co">## SL_s                                                           </span></span>
<span><span class="co">## sex_stageI                                                     </span></span>
<span><span class="co">## sex_stageM                                                     </span></span>
<span><span class="co">## pl_trtmntdc                                                    </span></span>
<span><span class="co">## pl_trtmntnc                                                    </span></span>
<span><span class="co">## SL_s:sx_stI                                                    </span></span>
<span><span class="co">## SL_s:sx_stM                                                    </span></span>
<span><span class="co">## sx_stgI:pl_trtmntd -0.020                                      </span></span>
<span><span class="co">## sx_stgM:pl_trtmntd -0.041  0.312                               </span></span>
<span><span class="co">## sx_stgI:pl_trtmntn  0.019  0.359              0.092            </span></span>
<span><span class="co">## sx_stgM:pl_trtmntn -0.097  0.107              0.386            </span></span>
<span><span class="co">##                    sx_stgI:pl_trtmntn</span></span>
<span><span class="co">## SL_s                                 </span></span>
<span><span class="co">## sex_stageI                           </span></span>
<span><span class="co">## sex_stageM                           </span></span>
<span><span class="co">## pl_trtmntdc                          </span></span>
<span><span class="co">## pl_trtmntnc                          </span></span>
<span><span class="co">## SL_s:sx_stI                          </span></span>
<span><span class="co">## SL_s:sx_stM                          </span></span>
<span><span class="co">## sx_stgI:pl_trtmntd                   </span></span>
<span><span class="co">## sx_stgM:pl_trtmntd                   </span></span>
<span><span class="co">## sx_stgI:pl_trtmntn                   </span></span>
<span><span class="co">## sx_stgM:pl_trtmntn  0.263</span></span></code></pre>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">s0</span>, <span class="va">s0b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     df      AIC</span></span>
<span><span class="co">## s0  13 781.9368</span></span>
<span><span class="co">## s0b 13 782.8971</span></span></code></pre>
<p>Given the difference in AIC value is larger than 4, I will consider
the model with density as a continuous value</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plotting</span></span>
<span><span class="va">mean_s</span> <span class="op">&lt;-</span> <span class="va">released</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">streamID</span>, <span class="va">pool_treatment</span>, <span class="va">pool_density</span>, <span class="va">sex_stage</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>survival <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">recaptured</span><span class="op">)</span>,</span>
<span>            n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            survival_SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">survival</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">survival</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">streamID</span>, <span class="va">pool_density</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="st">"stream"</span> <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">streamID</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CL1"</span>, <span class="st">"CL2"</span>, <span class="st">"TL"</span><span class="op">)</span>,</span>
<span>                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Caigual 1"</span>, <span class="st">"Caigual 2"</span>, <span class="st">"Taylor"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         sex <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">sex_stage</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"I"</span>, <span class="st">"M"</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"females"</span>, <span class="st">"immature"</span>, <span class="st">"males"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         upperCI <span class="op">=</span> <span class="va">survival</span> <span class="op">+</span> <span class="va">survival_SE</span>,</span>
<span>         lowerCI <span class="op">=</span> <span class="va">survival</span> <span class="op">-</span> <span class="va">survival_SE</span>,</span>
<span>         upperCI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">upperCI</span> <span class="op">&gt;</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="va">upperCI</span><span class="op">)</span>,</span>
<span>         lowerCI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">lowerCI</span> <span class="op">&lt;</span> <span class="fl">0</span> , <span class="fl">0</span>, <span class="va">lowerCI</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'streamID', 'pool_treatment',</span></span>
<span><span class="co">## 'pool_density'. You can override using the `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mean_s</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pool_density</span>, y <span class="op">=</span> <span class="va">survival</span>, </span>
<span>                        group <span class="op">=</span> <span class="va">stream</span>, color <span class="op">=</span> <span class="va">stream</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">stream</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">stream</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pool_density</span>, </span>
<span>                    ymin <span class="op">=</span> <span class="va">lowerCI</span>, </span>
<span>                    ymax <span class="op">=</span> <span class="va">upperCI</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>                position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#DAA323"</span>, <span class="st">"#691E92"</span>, <span class="st">"#199958"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Proportional change in density"</span>, y <span class="op">=</span> <span class="st">"Survival (± SE)"</span>,</span>
<span>       shape <span class="op">=</span> <span class="st">"Stream"</span>, color <span class="op">=</span> <span class="st">"Stream"</span>, linetype <span class="op">=</span> <span class="st">"Stream"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="DME-020_Density_dependence_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">jpeg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"figures"</span>, <span class="st">"pool_level_survival.jpeg"</span><span class="op">)</span>,</span>
<span>     width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Seba De Bona, Matthieu Bruneaux, Andrés López-Sepulcre.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
