<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dispersal and Habitat shift • guppyDme</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dispersal and Habitat shift">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">guppyDme</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analyses

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DME-000_Tidy_data.html">Spread and Shrink Dataset</a>
    </li>
    <li>
      <a href="../articles/DME-011_Measurement_consistency.html">Measurement consistency</a>
    </li>
    <li>
      <a href="../articles/DME-010_Habitat_characteristics.html">Habitat characteristics</a>
    </li>
    <li>
      <a href="../articles/DME-015_Habitat_area.html">Habitat area</a>
    </li>
    <li>
      <a href="../articles/DME-016_Dispersal_and_habitat_shift.html">Dispersal and Habitat shift</a>
    </li>
    <li>
      <a href="../articles/DME-020_Density_dependence.html">Density Dependence</a>
    </li>
    <li>
      <a href="../articles/DME-030_Habitat_use.html">Habitat Use</a>
    </li>
    <li>
      <a href="../articles/DME-035_DD_habitat_use.html">Density-Dependent Habitat Use</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://gitlab.com/sebadebona/guppyDME" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dispersal and Habitat shift</h1>
                        <h4 data-toc-skip class="author">Seba De
Bona</h4>
            
      
      <small class="dont-index">Source: <a href="https://gitlab.com/sebadebona/density-manipulation-experiment/blob/HEAD/vignettes/DME-016_Dispersal_and_habitat_shift.Rmd" class="external-link"><code>vignettes/DME-016_Dispersal_and_habitat_shift.Rmd</code></a></small>
      <div class="hidden name"><code>DME-016_Dispersal_and_habitat_shift.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview-setup">Overview &amp; Setup<a class="anchor" aria-label="anchor" href="#overview-setup"></a>
</h2>
<p>Here we will analyse the effects of density on dispersal. Our
hypothesis is that higher density will force more individuals to
disperse, given the stronger competition over resources.</p>
<p>This vignette relies on previous vignettes (000, 010, 015) having
run, since it builds upon the capture-recapture dataset we
generated.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">stargazer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># this vignette requires the package guppyDme to be installed. If the user wishes not to install the package, please comment out the "library(guppyDme)" line and run instead the lines commented out below</span></span>
<span></span>
<span><span class="co">#### If you have the guppyDme package installed</span></span>
<span><span class="co"># loading package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/sebadebona/density-manipulation-experiment" class="external-link">guppyDme</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># # If you do NOT wish to install the guppyDme package, please uncomment and run the following two lines of code, adding the package functions to the Global Environment and loading the data</span></span>
<span><span class="co"># source(file.path(here::here(), "R", "package_functions.R"))</span></span>
<span></span>
<span><span class="co"># here we load the capture-recapture dataset.</span></span>
<span><span class="va">cr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"DME_cr_data.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dispersal">Dispersal<a class="anchor" aria-label="anchor" href="#dispersal"></a>
</h2>
<p>Let’s have a look at the fluxes of dispersal between different
treatments.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># here all individuals</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">moved</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pool_treat_1</span>, <span class="va">pool_treat_0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>  <span class="va">print</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             pool_treat_0</span></span>
<span><span class="co">## pool_treat_1 control decreased increased natural</span></span>
<span><span class="co">##    control         1         1        19       7</span></span>
<span><span class="co">##    decreased       7         0        17      14</span></span>
<span><span class="co">##    increased      14         8         1       3</span></span>
<span><span class="co">##    natural        10         4        22      15</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pool_treat_0</span>, y <span class="op">=</span> <span class="va">pool_treat_1</span>, fill <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"YlOrRd"</span>, direction <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"destination"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"origin"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">Freq</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"All individuals"</span><span class="op">)</span></span></code></pre></div>
<p><img src="DME-016_Dispersal_and_habitat_shift_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>This graphic representation includes individuals from the
extra-limital reaches introduced into the increased-density pool. Let’s
have a look at “resident” individuals only. Also, We’ll be pooling
together “control” and “natural” areas since density should be at the
equilibrium in both.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat1</span> <span class="op">&lt;-</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">moved</span>, <span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"I"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pool_treat_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pool_treat_1</span><span class="op">==</span><span class="st">"natural"</span>, <span class="st">"control"</span>, <span class="va">pool_treat_1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pool_treat_1</span>, <span class="va">pool_treat_0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pool_treat_0</span>, y <span class="op">=</span> <span class="va">pool_treat_1</span>, fill <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"YlOrRd"</span>, direction <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"destination"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"origin"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">Freq</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Extralimital excluded"</span><span class="op">)</span></span></code></pre></div>
<p><img src="DME-016_Dispersal_and_habitat_shift_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>To test for the effect of density on dispersal we’ll run GLMM with
binomial error distribution. We will include interval (time) as an
<code>offset</code>, which in binomial models needs not be in the log
scale (see: <a href="https://stats.stackexchange.com/questions/25415/using-offset-in-binomial-model-to-account-for-increased-numbers-of-patients" class="external-link">here</a>
). The model with a non-logged <code>offset</code> throws an error, so
we will have interval as a covariate for now.</p>
<p>First, we will run the model including density as a
<strong>continuous</strong> factor, together with initial standard
length and sex-stage.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># it might be best to rescale the variables to improve model convergence</span></span>
<span><span class="co"># I am also only selecting resident individuals (excluding extralimital</span></span>
<span><span class="co"># in increased density pools)</span></span>
<span><span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SL_0s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">SL_0</span><span class="op">)</span>,</span>
<span>         interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">interval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         density_factor <span class="op">=</span> <span class="va">density_factor</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span>, </span>
<span>                                   optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxfun <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span>
<span><span class="co"># remove the three way (not significant at the .10 level)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_0s</span><span class="op">+</span><span class="va">sex_stage_0</span><span class="op">+</span><span class="va">density_factor</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span>, </span>
<span>                                   optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxfun <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span>
<span><span class="co"># remove size x density</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span><span class="op">+</span><span class="va">sex_stage_0</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span>, </span>
<span>                                   optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxfun <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span>
<span><span class="co"># remove sex x density</span></span>
<span><span class="va">d3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span><span class="op">+</span><span class="va">density_factor</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span>, </span>
<span>                                   optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxfun <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span>
<span><span class="co"># remove density</span></span>
<span><span class="va">d4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="st">"bobyqa"</span>, </span>
<span>                                   optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxfun <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">d0</span>, <span class="va">d1</span>, <span class="va">d2</span>, <span class="va">d3</span>, <span class="va">d4</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"html"</span>, report <span class="op">=</span> <span class="op">(</span><span class="st">'vcp*'</span><span class="op">)</span>,</span>
<span>                     title  <span class="op">=</span> <span class="st">"Model selection (continous density)"</span>,</span>
<span>                     dep.var.labels <span class="op">=</span> <span class="st">'Probability to disperse'</span>,</span>
<span>                     column.sep.width <span class="op">=</span> <span class="st">"10pt"</span>,</span>
<span>                     omit.stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bic"</span><span class="op">)</span>,</span>
<span>                     star.char <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'.'</span>, <span class="st">'*'</span>, <span class="st">'**'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Model selection (continous density)</strong>
</caption>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="5">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="5" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="5">
Probability to disperse
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
<td>
(5)
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s
</td>
<td>
-0.668
</td>
<td>
-0.588
</td>
<td>
-0.571
</td>
<td>
-0.568
</td>
<td>
-0.567
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.026<sup>*</sup>
</td>
<td>
p = 0.033<sup>*</sup>
</td>
<td>
p = 0.032<sup>*</sup>
</td>
<td>
p = 0.035<sup>*</sup>
</td>
<td>
p = 0.035<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0I
</td>
<td>
0.727
</td>
<td>
0.564
</td>
<td>
0.674
</td>
<td>
0.755
</td>
<td>
0.748
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.176
</td>
<td>
p = 0.318
</td>
<td>
p = 0.212
</td>
<td>
p = 0.156
</td>
<td>
p = 0.159
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0M
</td>
<td>
2.511
</td>
<td>
2.257
</td>
<td>
2.308
</td>
<td>
2.041
</td>
<td>
2.055
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.003<sup>**</sup>
</td>
<td>
p = 0.001<sup>**</sup>
</td>
<td>
p = 0.001<sup>**</sup>
</td>
<td>
p = 0.0005<sup>**</sup>
</td>
<td>
p = 0.0005<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
density_factor
</td>
<td>
-1.589
</td>
<td>
-0.989
</td>
<td>
-0.418
</td>
<td>
0.148
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.068<sup>.</sup>
</td>
<td>
p = 0.214
</td>
<td>
p = 0.528
</td>
<td>
p = 0.747
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0I
</td>
<td>
1.670
</td>
<td>
1.373
</td>
<td>
1.474
</td>
<td>
1.422
</td>
<td>
1.419
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.005<sup>**</sup>
</td>
<td>
p = 0.019<sup>*</sup>
</td>
<td>
p = 0.010<sup>**</sup>
</td>
<td>
p = 0.012<sup>*</sup>
</td>
<td>
p = 0.012<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0M
</td>
<td>
2.744
</td>
<td>
1.321
</td>
<td>
1.535
</td>
<td>
1.981
</td>
<td>
1.943
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.223
</td>
<td>
p = 0.409
</td>
<td>
p = 0.338
</td>
<td>
p = 0.195
</td>
<td>
p = 0.203
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:density_factor
</td>
<td>
2.192
</td>
<td>
1.036
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.029<sup>*</sup>
</td>
<td>
p = 0.180
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0I:density_factor
</td>
<td>
2.005
</td>
<td>
3.024
</td>
<td>
1.602
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.187
</td>
<td>
p = 0.038<sup>*</sup>
</td>
<td>
p = 0.101
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0M:density_factor
</td>
<td>
-1.195
</td>
<td>
-0.343
</td>
<td>
-1.154
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.628
</td>
<td>
p = 0.842
</td>
<td>
p = 0.476
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0I:density_factor
</td>
<td>
-3.174
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.053<sup>.</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0M:density_factor
</td>
<td>
-7.355
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.253
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-1.459
</td>
<td>
-1.448
</td>
<td>
-1.472
</td>
<td>
-1.501
</td>
<td>
-1.493
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.076<sup>.</sup>
</td>
<td>
p = 0.078<sup>.</sup>
</td>
<td>
p = 0.073<sup>.</sup>
</td>
<td>
p = 0.063<sup>.</sup>
</td>
<td>
p = 0.064<sup>.</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
362
</td>
<td>
362
</td>
<td>
362
</td>
<td>
362
</td>
<td>
362
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-163.488
</td>
<td>
-165.888
</td>
<td>
-166.838
</td>
<td>
-168.987
</td>
<td>
-169.039
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
352.976
</td>
<td>
353.775
</td>
<td>
353.676
</td>
<td>
353.973
</td>
<td>
352.077
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="5" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Since there might be some asymmetry in the way density affects
dispersal, we will also try to fit a model with treatment as a
<strong>categorical</strong> variable, and the same structure of
covariates.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span><span class="op">*</span><span class="va">treatment</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span><span class="co">## unable to evaluate scaled gradient</span></span></code></pre>
<pre><code><span><span class="co">## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :</span></span>
<span><span class="co">## Model failed to converge: degenerate Hessian with 1 negative eigenvalues</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the model throws some convergence warnings</span></span>
<span><span class="va">d2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_0s</span><span class="op">+</span><span class="va">sex_stage_0</span><span class="op">+</span><span class="va">treatment</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: large eigenvalue ratio</span></span>
<span><span class="co">##  - Rescale variables?</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span><span class="op">+</span><span class="va">SL_0s</span><span class="op">*</span><span class="va">treatment</span>  <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span>
<span><span class="va">d4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span><span class="op">+</span><span class="va">treatment</span>  <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span>
<span><span class="va">d5b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"binomial"</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># displaying model comparison (the first two models don't converge and are not reported)</span></span>
<span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">d3b</span>, <span class="va">d4b</span>, <span class="va">d5b</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"html"</span>, report <span class="op">=</span> <span class="op">(</span><span class="st">'vcp*'</span><span class="op">)</span>,</span>
<span>                     title  <span class="op">=</span> <span class="st">"Model selection (factorial density)"</span>,</span>
<span>                     dep.var.labels <span class="op">=</span> <span class="st">'Probability to disperse'</span>,</span>
<span>                     column.sep.width <span class="op">=</span> <span class="st">"10pt"</span>,</span>
<span>                     omit.stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bic"</span><span class="op">)</span>,</span>
<span>                     star.char <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'.'</span>, <span class="st">'*'</span>, <span class="st">'**'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Model selection (factorial density)</strong>
</caption>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
Probability to disperse
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s
</td>
<td>
-0.319
</td>
<td>
-0.589
</td>
<td>
-0.567
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.288
</td>
<td>
p = 0.029<sup>*</sup>
</td>
<td>
p = 0.035<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0I
</td>
<td>
0.754
</td>
<td>
0.717
</td>
<td>
0.748
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.159
</td>
<td>
p = 0.179
</td>
<td>
p = 0.159
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0M
</td>
<td>
2.031
</td>
<td>
2.014
</td>
<td>
2.055
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.001<sup>**</sup>
</td>
<td>
p = 0.001<sup>**</sup>
</td>
<td>
p = 0.0005<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
treatmentD
</td>
<td>
0.317
</td>
<td>
0.433
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.456
</td>
<td>
p = 0.284
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
treatmentI
</td>
<td>
0.082
</td>
<td>
0.178
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.803
</td>
<td>
p = 0.576
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0I
</td>
<td>
1.499
</td>
<td>
1.412
</td>
<td>
1.419
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.010<sup>**</sup>
</td>
<td>
p = 0.013<sup>*</sup>
</td>
<td>
p = 0.012<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0M
</td>
<td>
2.034
</td>
<td>
1.881
</td>
<td>
1.943
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.192
</td>
<td>
p = 0.222
</td>
<td>
p = 0.203
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:treatmentD
</td>
<td>
-0.633
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.186
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:treatmentI
</td>
<td>
-0.576
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.166
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-1.561
</td>
<td>
-1.614
</td>
<td>
-1.493
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.057<sup>.</sup>
</td>
<td>
p = 0.048<sup>*</sup>
</td>
<td>
p = 0.064<sup>.</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
362
</td>
<td>
362
</td>
<td>
362
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-166.981
</td>
<td>
-168.451
</td>
<td>
-169.039
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
355.962
</td>
<td>
354.901
</td>
<td>
352.077
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="3" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>The two resulting models, from our model simplification approach, are
the same whether treatment (density) is included as a continuous or
categorical variable, so there is no need to compare AIC values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span><span class="co">##   Approximation) [glmerMod]</span></span>
<span><span class="co">##  Family: binomial  ( logit )</span></span>
<span><span class="co">## Formula: moved ~ SL_0s * sex_stage_0 + (1 | streamID)</span></span>
<span><span class="co">##    Data: cr_data</span></span>
<span><span class="co">##  Offset: interval</span></span>
<span><span class="co">## Control: glmerControl(optimizer = "bobyqa", optCtrl = list(maxfun = 1e+05))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">##    352.1    379.3   -169.0    338.1      355 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -1.3415 -0.4856 -0.4066 -0.2703  8.7115 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  streamID (Intercept) 1.774    1.332   </span></span>
<span><span class="co">## Number of obs: 362, groups:  streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                    Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)         -1.4933     0.8058  -1.853  0.06385 .  </span></span>
<span><span class="co">## SL_0s               -0.5669     0.2680  -2.115  0.03440 *  </span></span>
<span><span class="co">## sex_stage_0I         0.7483     0.5307   1.410  0.15851    </span></span>
<span><span class="co">## sex_stage_0M         2.0550     0.5826   3.527  0.00042 ***</span></span>
<span><span class="co">## SL_0s:sex_stage_0I   1.4186     0.5632   2.519  0.01177 *  </span></span>
<span><span class="co">## SL_0s:sex_stage_0M   1.9429     1.5247   1.274  0.20257    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) SL_0s  sx__0I sx__0M SL_0:__0I</span></span>
<span><span class="co">## SL_0s       -0.139                               </span></span>
<span><span class="co">## sex_stag_0I -0.133  0.209                        </span></span>
<span><span class="co">## sex_stag_0M -0.123  0.183  0.178                 </span></span>
<span><span class="co">## SL_0s:s__0I  0.061 -0.471  0.590 -0.067          </span></span>
<span><span class="co">## SL_0s:s__0M  0.012 -0.160 -0.024  0.648  0.089</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># quick plot to have a visual idea</span></span>
<span><span class="va">mean_dispersal</span> <span class="op">&lt;-</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">streamID</span>, <span class="va">treatment</span>, <span class="va">density_factor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>p_mov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">moved</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            st_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">moved</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>se <span class="op">=</span> <span class="va">st_dev</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'streamID', 'treatment'. You can override</span></span>
<span><span class="co">## using the `.groups` argument.</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># then against the continuous density</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mean_dispersal</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">density_factor</span>, y <span class="op">=</span> <span class="va">p_mov</span>, col <span class="op">=</span> <span class="va">streamID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">p_mov</span> <span class="op">-</span> <span class="va">se</span><span class="op">*</span><span class="fl">2</span>, ymax<span class="op">=</span><span class="va">p_mov</span> <span class="op">+</span> <span class="va">se</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"density multiplier"</span>, y <span class="op">=</span> <span class="st">"Dispersal probability"</span>, color <span class="op">=</span> <span class="st">"Stream"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#DAA323"</span>, <span class="st">"#691E92"</span>, <span class="st">"#199958"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Dispersal probability as a function of density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="DME-016_Dispersal_and_habitat_shift_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>We can dive a little deeper into how dispersal probability changes
based on size and sex and density. The plot below shows the predicted
dispersal probability as a function of standard length (in mm),
marginalized over the random effect <code>stream_ID</code>, for females,
males, and immature individuals separately. The predictions are bound to
the appropriate parameter space, spanning from the minimum and maximum
recorded size for each of the three sex-stage categories.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generating newdata to predict probability to disperse</span></span>
<span><span class="va">sls</span> <span class="op">&lt;-</span> <span class="fu">modelr</span><span class="fu">::</span><span class="fu"><a href="https://modelr.tidyverse.org/reference/seq_range.html" class="external-link">seq_range</a></span><span class="op">(</span><span class="va">cr_data</span><span class="op">$</span><span class="va">SL_0</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">sxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cr_data</span><span class="op">$</span><span class="va">sex_stage_0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>SL_0 <span class="op">=</span> <span class="va">sls</span>,</span>
<span>                       sex_stage_0 <span class="op">=</span> <span class="va">sxs</span><span class="op">)</span></span>
<span><span class="va">newdata_disp</span> <span class="op">&lt;-</span> <span class="va">newdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SL_0s <span class="op">=</span> <span class="op">(</span><span class="va">SL_0</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_data</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:center"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_data</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:scale"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>pred_mov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">d4</span>, newdata <span class="op">=</span> <span class="va">.</span>, re.form <span class="op">=</span> <span class="op">~</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sex_stage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex_stage_0</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">(</span><span class="va">sex_stage</span> <span class="op">==</span> <span class="st">"M"</span> <span class="op">&amp;</span> </span>
<span>           <span class="fu">in_range</span><span class="op">(</span><span class="va">SL_0</span>, <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex_stage_0</span> <span class="op">==</span> <span class="st">"M"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span> <span class="op">(</span><span class="va">SL_0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>           <span class="op">(</span><span class="va">sex_stage</span> <span class="op">==</span> <span class="st">"I"</span> <span class="op">&amp;</span> </span>
<span>           <span class="fu">in_range</span><span class="op">(</span><span class="va">SL_0</span>, <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex_stage_0</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span> <span class="op">(</span><span class="va">SL_0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>           <span class="op">(</span><span class="va">sex_stage</span> <span class="op">==</span> <span class="st">"F"</span> <span class="op">&amp;</span> </span>
<span>              <span class="fu">in_range</span><span class="op">(</span><span class="va">SL_0</span>, <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex_stage_0</span> <span class="op">==</span> <span class="st">"F"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span> <span class="op">(</span><span class="va">SL_0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">sex_stage</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"immature"</span>, <span class="st">"males"</span>, <span class="st">"females"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># creating new variable to uniform color</span></span>
<span><span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sex_lett <span class="op">=</span><span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">sex_stage_0</span>,</span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span>,</span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"immature"</span>, <span class="st">"males"</span>, <span class="st">"females"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extracting model matrix from selected model and newdata</span></span>
<span><span class="co"># sourced here(https://stackoverflow.com/questions/53255211/plotting-random-effects-for-a-binomial-glmer-in-ggplot)</span></span>
<span><span class="va">Xmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">SL_0s</span> <span class="op">*</span> <span class="va">sex_stage_0</span>, <span class="va">newdata_disp</span><span class="op">)</span></span>
<span><span class="co"># extracting fixed effect vector</span></span>
<span><span class="va">fixest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span></span>
<span><span class="co"># calculating predicted values</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">fixest</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Xmat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># calculating the standard error each estimates</span></span>
<span><span class="va">SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Xmat</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">d4</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Xmat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># binomial link function</span></span>
<span><span class="va">linkinv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">linkinv</span></span>
<span></span>
<span><span class="co"># adding CI to newdata</span></span>
<span><span class="va">newdata_disp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="fu">linkinv</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>,</span>
<span>             lower <span class="op">=</span> <span class="fu">linkinv</span><span class="op">(</span><span class="va">fit</span> <span class="op">-</span> <span class="va">SE</span><span class="op">)</span>,</span>
<span>             upper <span class="op">=</span> <span class="fu">linkinv</span><span class="op">(</span><span class="va">fit</span> <span class="op">+</span> <span class="va">SE</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">newdata_disp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, y <span class="op">=</span> <span class="va">fitted</span>, colour <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>, </span>
<span>              color <span class="op">=</span> <span class="st">"transparent"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">moved</span><span class="op">)</span>, </span>
<span>                 colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sex_lett</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"immature"</span>, <span class="st">"males"</span>, <span class="st">"females"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0</span>, h <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1E88E5"</span>, <span class="st">"#FFC107"</span>, <span class="st">"#004D40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1E88E5"</span>, <span class="st">"#FFC107"</span>, <span class="st">"#004D40"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Standard length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Dispersal probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pd</span></span></code></pre></div>
<p><img src="DME-016_Dispersal_and_habitat_shift_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># saving figure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"figures"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in dir.create(file.path(here::here(), "vignettes", "figures")):</span></span>
<span><span class="co">## '/Users/sebastianodebona/Documents/Research/R</span></span>
<span><span class="co">## packages/guppyDME/vignettes/figures' already exists</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">jpeg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"figures"</span>, <span class="st">"dispersal_p_by_sex.jpeg"</span><span class="op">)</span>,</span>
<span>     width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">pd</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="habitat-shift">Habitat shift<a class="anchor" aria-label="anchor" href="#habitat-shift"></a>
</h2>
<p>Again, let’s first visualize what type of habitat change we observe
in the three different pools, among individuals that stayed and left the
pool.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">habitat_0</span>, <span class="va">habitat_1</span>, <span class="va">treatment</span>, <span class="va">moved</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/tee.html" class="external-link">%T&gt;%</a></span></span>
<span>  <span class="va">print</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## , , treatment = C, moved = FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          habitat_1</span></span>
<span><span class="co">## habitat_0  A  B  C  D  E</span></span>
<span><span class="co">##         A 10  0 16  0  3</span></span>
<span><span class="co">##         B  9  0 10  0  0</span></span>
<span><span class="co">##         C  8  0 59  0  4</span></span>
<span><span class="co">##         D  3  0  7  0  6</span></span>
<span><span class="co">##         E  5  0  6  0  9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , treatment = D, moved = FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          habitat_1</span></span>
<span><span class="co">## habitat_0  A  B  C  D  E</span></span>
<span><span class="co">##         A  4  0  6  0  0</span></span>
<span><span class="co">##         B  1  0  5  0  0</span></span>
<span><span class="co">##         C  7  0 18  0  0</span></span>
<span><span class="co">##         D  0  0  1  0  0</span></span>
<span><span class="co">##         E  0  0  0  0  0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , treatment = I, moved = FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          habitat_1</span></span>
<span><span class="co">## habitat_0  A  B  C  D  E</span></span>
<span><span class="co">##         A  6  0 14  0  0</span></span>
<span><span class="co">##         B  8  0 22  0  0</span></span>
<span><span class="co">##         C  5  0 18  0  0</span></span>
<span><span class="co">##         D  4  0 11  0  0</span></span>
<span><span class="co">##         E  0  0  0  0  0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , treatment = C, moved = TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          habitat_1</span></span>
<span><span class="co">## habitat_0  A  B  C  D  E</span></span>
<span><span class="co">##         A  1  0  2  0  0</span></span>
<span><span class="co">##         B  1  0  1  0  1</span></span>
<span><span class="co">##         C  2  0 15  0  0</span></span>
<span><span class="co">##         D  0  0  1  0  0</span></span>
<span><span class="co">##         E  0  0  4  0  0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , treatment = D, moved = TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          habitat_1</span></span>
<span><span class="co">## habitat_0  A  B  C  D  E</span></span>
<span><span class="co">##         A  1  0  2  0  0</span></span>
<span><span class="co">##         B  0  0  1  1  0</span></span>
<span><span class="co">##         C  3  0  4  0  0</span></span>
<span><span class="co">##         D  0  0  0  0  0</span></span>
<span><span class="co">##         E  0  0  0  0  0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , treatment = I, moved = TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          habitat_1</span></span>
<span><span class="co">## habitat_0  A  B  C  D  E</span></span>
<span><span class="co">##         A  1  0  2  0  0</span></span>
<span><span class="co">##         B  1  0  3  0  2</span></span>
<span><span class="co">##         C  3  0  4  1  0</span></span>
<span><span class="co">##         D  1  0  5  0  1</span></span>
<span><span class="co">##         E  0  0  0  0  0</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pool_lables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span> <span class="op">=</span> <span class="st">"control"</span>,</span>
<span>                <span class="st">"D"</span> <span class="op">=</span> <span class="st">"decreased"</span>,</span>
<span>                <span class="st">"I"</span> <span class="op">=</span> <span class="st">"increased"</span><span class="op">)</span></span>
<span><span class="va">moved_labels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"STAYED"</span>,</span>
<span>                 <span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"DISPERSED"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">habitat_0</span>, y <span class="op">=</span> <span class="va">habitat_1</span>, fill <span class="op">=</span> <span class="va">Freq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"YlOrRd"</span>, direction <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"destination"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"origin"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">Freq</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">moved</span> <span class="op">~</span> <span class="va">treatment</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="va">pool_lables</span>, moved <span class="op">=</span> <span class="va">moved_labels</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="DME-016_Dispersal_and_habitat_shift_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>A lot of individuals that stayed in the same pool (did not disperse)
have moved to the core of the pool.</p>
<p>We will repeat the same analyses as we did before for dispersal, but
now for habitat shift. In addition, we are including a quadratic term
since we expect both an increase and a decrease in density could result
in habitat change (for either worse or better habitats,
respectively).</p>
<p>We’ll analyse individuals that did not disperse, as individuals who
did disperse have changed pool as well as microhabitat, and the choice
to shift microhabitat might therefore be confounded.</p>
<p>Given the very small sample size, it’s impossible here to analyse the
full model that includes treatment as a factor (the model is rank
deficient). To account for asymmetries in the response to density we
will instead include a quadratic term.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here, individuals who stayed are filtered</span></span>
<span><span class="va">h1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">hshift</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">density_factor</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bobyqa"</span><span class="op">)</span>, </span>
<span>                                   optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxfun <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            family  <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="co"># 3-way removed</span></span>
<span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">hshift</span> <span class="op">~</span> <span class="op">(</span><span class="va">SL_0s</span><span class="op">+</span><span class="va">sex_stage_0</span><span class="op">+</span><span class="va">density_factor</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">density_factor</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bobyqa"</span><span class="op">)</span>, </span>
<span>                                   optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxfun <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            family  <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="co"># sex x density removed </span></span>
<span><span class="va">h3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">hshift</span> <span class="op">~</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">sex_stage_0</span> <span class="op">+</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">density_factor</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bobyqa"</span><span class="op">)</span>, </span>
<span>                                   optCtrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxfun <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            family  <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="co"># size x sex removed</span></span>
<span><span class="va">h4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">hshift</span> <span class="op">~</span>  <span class="va">SL_0s</span> <span class="op">+</span> <span class="va">sex_stage_0</span> <span class="op">+</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">density_factor</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            family  <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="co"># quadratic density term removed</span></span>
<span><span class="va">h5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">hshift</span> <span class="op">~</span>  <span class="va">SL_0s</span> <span class="op">+</span> <span class="va">sex_stage_0</span> <span class="op">+</span> <span class="va">SL_0s</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            family  <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="co"># sex removed</span></span>
<span><span class="va">h6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">hshift</span> <span class="op">~</span>  <span class="va">SL_0s</span><span class="op">*</span><span class="va">density_factor</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            family  <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="co"># simplified model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">h6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span><span class="co">##   Approximation) [glmerMod]</span></span>
<span><span class="co">##  Family: binomial  ( logit )</span></span>
<span><span class="co">## Formula: hshift ~ SL_0s * density_factor + (1 | streamID)</span></span>
<span><span class="co">##    Data: cr_data %&gt;% filter(!moved)</span></span>
<span><span class="co">##  Offset: interval</span></span>
<span><span class="co">## Control: glmerControl(optimizer = c("bobyqa"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">##    364.1    382.4   -177.1    354.1      280 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.9465 -0.7611  0.4396  0.7465  2.7290 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  streamID (Intercept) 3.25     1.803   </span></span>
<span><span class="co">## Number of obs: 285, groups:  streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                      Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)            0.2111     1.0499   0.201  0.84061    </span></span>
<span><span class="co">## SL_0s                 -0.1534     0.1255  -1.223  0.22151    </span></span>
<span><span class="co">## density_factor         2.1329     0.5036   4.235 2.28e-05 ***</span></span>
<span><span class="co">## SL_0s:density_factor  -1.1568     0.4014  -2.882  0.00395 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) SL_0s  dnsty_</span></span>
<span><span class="co">## SL_0s       -0.015              </span></span>
<span><span class="co">## densty_fctr -0.002 -0.056       </span></span>
<span><span class="co">## SL_0s:dnst_  0.005  0.085 -0.308</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># displaying model comparison</span></span>
<span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">h1</span>, <span class="va">h2</span>, <span class="va">h3</span>, <span class="va">h4</span>, <span class="va">h5</span>, <span class="va">h6</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"html"</span>, report <span class="op">=</span> <span class="op">(</span><span class="st">'vcp*'</span><span class="op">)</span>,</span>
<span>                     title  <span class="op">=</span> <span class="st">"Model selection"</span>,</span>
<span>                     dep.var.labels <span class="op">=</span> <span class="st">''</span>,</span>
<span>                     column.sep.width <span class="op">=</span> <span class="st">"1pt"</span>,</span>
<span>                     font.size <span class="op">=</span> <span class="st">"tiny"</span>,</span>
<span>                     omit.stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bic"</span><span class="op">)</span>,</span>
<span>                     star.char <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'.'</span>, <span class="st">'*'</span>, <span class="st">'**'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Model selection</strong>
</caption>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="6">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="6">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
<td>
(5)
</td>
<td>
(6)
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s
</td>
<td>
-0.156
</td>
<td>
-0.160
</td>
<td>
-0.184
</td>
<td>
-0.184
</td>
<td>
-0.136
</td>
<td>
-0.153
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.451
</td>
<td>
p = 0.438
</td>
<td>
p = 0.365
</td>
<td>
p = 0.336
</td>
<td>
p = 0.469
</td>
<td>
p = 0.222
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0I
</td>
<td>
-0.215
</td>
<td>
-0.236
</td>
<td>
-0.255
</td>
<td>
0.010
</td>
<td>
0.026
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.735
</td>
<td>
p = 0.706
</td>
<td>
p = 0.691
</td>
<td>
p = 0.982
</td>
<td>
p = 0.952
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0M
</td>
<td>
6.188
</td>
<td>
1.556
</td>
<td>
1.777
</td>
<td>
0.349
</td>
<td>
0.433
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.168
</td>
<td>
p = 0.240
</td>
<td>
p = 0.105
</td>
<td>
p = 0.605
</td>
<td>
p = 0.512
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
density_factor
</td>
<td>
3.043
</td>
<td>
2.912
</td>
<td>
2.189
</td>
<td>
2.170
</td>
<td>
2.082
</td>
<td>
2.133
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.002<sup>**</sup>
</td>
<td>
p = 0.002<sup>**</sup>
</td>
<td>
p = 0.00005<sup>**</sup>
</td>
<td>
p = 0.00005<sup>**</sup>
</td>
<td>
p = 0.00005<sup>**</sup>
</td>
<td>
p = 0.00003<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
I(density_factor2)
</td>
<td>
1.286
</td>
<td>
1.393
</td>
<td>
1.819
</td>
<td>
1.739
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.297
</td>
<td>
p = 0.254
</td>
<td>
p = 0.123
</td>
<td>
p = 0.138
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0I
</td>
<td>
-0.282
</td>
<td>
-0.295
</td>
<td>
-0.273
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.639
</td>
<td>
p = 0.621
</td>
<td>
p = 0.653
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0M
</td>
<td>
25.231
</td>
<td>
5.296
</td>
<td>
4.917
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.231
</td>
<td>
p = 0.062<sup>.</sup>
</td>
<td>
p = 0.059<sup>.</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:density_factor
</td>
<td>
-1.848
</td>
<td>
-1.722
</td>
<td>
-1.204
</td>
<td>
-1.155
</td>
<td>
-1.135
</td>
<td>
-1.157
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.009<sup>**</sup>
</td>
<td>
p = 0.009<sup>**</sup>
</td>
<td>
p = 0.004<sup>**</sup>
</td>
<td>
p = 0.005<sup>**</sup>
</td>
<td>
p = 0.005<sup>**</sup>
</td>
<td>
p = 0.004<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0I:density_factor
</td>
<td>
-0.806
</td>
<td>
-1.755
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.706
</td>
<td>
p = 0.278
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
sex_stage_0M:density_factor
</td>
<td>
-15.037
</td>
<td>
0.713
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.233
</td>
<td>
p = 0.867
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0I:density_factor
</td>
<td>
1.403
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.496
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
SL_0s:sex_stage_0M:density_factor
</td>
<td>
-61.637
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.298
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.012
</td>
<td>
0.011
</td>
<td>
0.023
</td>
<td>
0.035
</td>
<td>
0.179
</td>
<td>
0.211
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
p = 0.991
</td>
<td>
p = 0.992
</td>
<td>
p = 0.983
</td>
<td>
p = 0.974
</td>
<td>
p = 0.868
</td>
<td>
p = 0.841
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
285
</td>
<td>
285
</td>
<td>
285
</td>
<td>
285
</td>
<td>
285
</td>
<td>
285
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-170.973
</td>
<td>
-172.989
</td>
<td>
-173.645
</td>
<td>
-175.727
</td>
<td>
-176.843
</td>
<td>
-177.069
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
369.945
</td>
<td>
369.978
</td>
<td>
367.291
</td>
<td>
367.454
</td>
<td>
367.686
</td>
<td>
364.138
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="6" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>The probability to change habitat increases at high density for
average sized individuals, but the opposite is true for large
individuals.</p>
<p>This can be explained with large individuals monopolizing resources
that are either inaccessible to smaller individuals (e.g. drift
feeding), or by holding them preferentially even when density is high
(context-competition like dynamic).</p>
<p>Below, we visualize the results with a plot.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># defining some representative points for density manipulation (50%, 100%, 150%)</span></span>
<span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculating predictions from selected model</span></span>
<span><span class="va">newdata_hab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>SL_0 <span class="op">=</span> <span class="va">sls</span>,</span>
<span>                          density_factor <span class="op">=</span> <span class="va">ds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SL_0s <span class="op">=</span> <span class="op">(</span><span class="va">SL_0</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_data</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:center"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_data</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:scale"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co">#add_column(pred_mov = plogis(predict(h6, newdata = ., re.form = ~0))) %&gt;%</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">density_factor</span>,</span>
<span>                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span> , <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decreased"</span>, <span class="st">"control"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decreased"</span>, <span class="st">"control"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extracting model matrix from selected model and newdata</span></span>
<span><span class="co"># sourced here(https://stackoverflow.com/questions/53255211/plotting-random-effects-for-a-binomial-glmer-in-ggplot)</span></span>
<span><span class="va">Xmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">SL_0s</span> <span class="op">*</span> <span class="va">density_factor</span>, <span class="va">newdata_hab</span><span class="op">)</span></span>
<span><span class="co"># extracting fixed effect vector</span></span>
<span><span class="va">fixest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">h6</span><span class="op">)</span></span>
<span><span class="co"># calculating predicted values</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">fixest</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Xmat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># calculating the standard error each estimates</span></span>
<span><span class="va">SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Xmat</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">h6</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Xmat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># binomial link function</span></span>
<span><span class="va">linkinv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">linkinv</span></span>
<span></span>
<span><span class="co"># adding CI to newdata</span></span>
<span><span class="va">newdata_hab</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="fu">linkinv</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>,</span>
<span>             lower <span class="op">=</span> <span class="fu">linkinv</span><span class="op">(</span><span class="va">fit</span> <span class="op">-</span> <span class="va">SE</span><span class="op">)</span>,</span>
<span>             upper <span class="op">=</span> <span class="fu">linkinv</span><span class="op">(</span><span class="va">fit</span> <span class="op">+</span> <span class="va">SE</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># creating column on cr_data to match newdata</span></span>
<span><span class="va">alt_data</span> <span class="op">&lt;-</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">treatment</span>,</span>
<span>                                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span><span class="op">)</span>,</span>
<span>                                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"decreased"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         <span class="co"># CAREFUL! The order here is very important and needs to match the order of treatment_lett above</span></span>
<span>         treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">newdata_hab</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">newdata_hab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, </span>
<span>                              y <span class="op">=</span> <span class="va">fitted</span>, </span>
<span>                              group <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">lower</span>, ymax<span class="op">=</span><span class="va">upper</span>, fill<span class="op">=</span><span class="va">treatment</span><span class="op">)</span>, color<span class="op">=</span><span class="cn">NA</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">alt_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, </span>
<span>                                  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hshift</span><span class="op">)</span>, </span>
<span>                                  fill <span class="op">=</span> <span class="va">treatment</span>, </span>
<span>                                  shape <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>             alpha <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0</span>, h <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffb14e"</span>, <span class="st">"#cd34b5"</span>, <span class="st">"#0000ff"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffb14e"</span>, <span class="st">"#cd34b5"</span>, <span class="st">"#0000ff"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">22</span>, <span class="fl">24</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Standard length (mm)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Predicted microhabitat change (p)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ph</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 186 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<p><img src="DME-016_Dispersal_and_habitat_shift_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># saving plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">jpeg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"figures"</span>, <span class="st">"microhabitat_shift_by_treatment.jpeg"</span><span class="op">)</span>,</span>
<span>     width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">ph</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 201 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## agg_png </span></span>
<span><span class="co">##       2</span></span></code></pre>
<p>Given it was impossible to fit the full model with treatment as a
factorial variable (model was rank deficient), we will briefly refit the
selected model with treatment as a factor instead of a continuous
variable, and compare the results.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># refitting model with categorical variable</span></span>
<span><span class="va">h6b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span><span class="va">hshift</span> <span class="op">~</span>  <span class="va">SL_0s</span><span class="op">*</span><span class="va">treatment</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">streamID</span><span class="op">)</span>,</span>
<span>            offset <span class="op">=</span> <span class="va">interval</span>,</span>
<span>            data <span class="op">=</span> <span class="va">cr_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">moved</span><span class="op">)</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">glmerControl</a></span><span class="op">(</span>optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bobyqa"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            family  <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">h6b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span><span class="co">##   Approximation) [glmerMod]</span></span>
<span><span class="co">##  Family: binomial  ( logit )</span></span>
<span><span class="co">## Formula: hshift ~ SL_0s * treatment + (1 | streamID)</span></span>
<span><span class="co">##    Data: cr_data %&gt;% filter(!moved)</span></span>
<span><span class="co">##  Offset: interval</span></span>
<span><span class="co">## Control: glmerControl(optimizer = c("bobyqa"))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      AIC      BIC   logLik deviance df.resid </span></span>
<span><span class="co">##    366.4    391.9   -176.2    352.4      278 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Scaled residuals: </span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -2.6575 -0.8960  0.4612  0.7318  2.2896 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Random effects:</span></span>
<span><span class="co">##  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">##  streamID (Intercept) 3.223    1.795   </span></span>
<span><span class="co">## Number of obs: 285, groups:  streamID, 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Fixed effects:</span></span>
<span><span class="co">##                  Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)      -0.03561    1.05196  -0.034  0.97300    </span></span>
<span><span class="co">## SL_0s            -0.37498    0.17305  -2.167  0.03024 *  </span></span>
<span><span class="co">## treatmentD       -0.39961    0.39282  -1.017  0.30901    </span></span>
<span><span class="co">## treatmentI        1.19129    0.31423   3.791  0.00015 ***</span></span>
<span><span class="co">## SL_0s:treatmentD  0.94136    0.32593   2.888  0.00387 ** </span></span>
<span><span class="co">## SL_0s:treatmentI  0.11873    0.32613   0.364  0.71582    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Correlation of Fixed Effects:</span></span>
<span><span class="co">##             (Intr) SL_0s  trtmnD trtmnI SL_0:D</span></span>
<span><span class="co">## SL_0s        0.005                            </span></span>
<span><span class="co">## treatmentD  -0.079 -0.014                     </span></span>
<span><span class="co">## treatmentI  -0.091 -0.033  0.211              </span></span>
<span><span class="co">## SL_0s:trtmD -0.006 -0.514 -0.130  0.035       </span></span>
<span><span class="co">## SL_0s:trtmI  0.002 -0.548  0.000 -0.099  0.268</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">h6</span>, <span class="va">h6b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     df      AIC</span></span>
<span><span class="co">## h6   5 364.1382</span></span>
<span><span class="co">## h6b  7 366.3683</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plotting</span></span>
<span><span class="va">tts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"I"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newdata_habb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>SL_0 <span class="op">=</span> <span class="va">sls</span>,</span>
<span>                          treatment <span class="op">=</span> <span class="va">tts</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>SL_0s <span class="op">=</span> <span class="op">(</span><span class="va">SL_0</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_data</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:center"</span><span class="op">)</span><span class="op">)</span><span class="op">/</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cr_data</span><span class="op">$</span><span class="va">SL_0s</span>, <span class="st">"scaled:scale"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>pred_mov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">h6b</span>, newdata <span class="op">=</span> <span class="va">.</span>, re.form <span class="op">=</span> <span class="op">~</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html" class="external-link">mapvalues</a></span><span class="op">(</span><span class="va">treatment</span>,</span>
<span>                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"I"</span><span class="op">)</span>,</span>
<span>                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decreased"</span>, <span class="st">"control"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">treatment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"decreased"</span>, <span class="st">"control"</span>, <span class="st">"increased"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">newdata_habb</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>,</span>
<span>                         y <span class="op">=</span> <span class="va">pred_mov</span>,</span>
<span>                         colour <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">alt_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SL_0</span>, </span>
<span>                                  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hshift</span><span class="op">)</span>, </span>
<span>                                  fill <span class="op">=</span> <span class="va">treatment</span>, </span>
<span>                                  shape <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>             alpha <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html" class="external-link">position_jitter</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0</span>, h <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffb14e"</span>, <span class="st">"#cd34b5"</span>, <span class="st">"#0000ff"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#ffb14e"</span>, <span class="st">"#cd34b5"</span>, <span class="st">"#0000ff"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">22</span>, <span class="fl">24</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"standard length (mm)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"predicted microhabitat change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 184 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">## (`geom_point()`).</span></span></code></pre>
<p><img src="DME-016_Dispersal_and_habitat_shift_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Seba De Bona, Matthieu Bruneaux, Andrés López-Sepulcre.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
